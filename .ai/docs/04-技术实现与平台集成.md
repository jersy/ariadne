# Compound Engineering Plugin æŠ€æœ¯å®ç°ä¸å¹³å°é›†æˆ

> **æ–‡æ¡£ç‰ˆæœ¬**: åŸºäº Compound Engineering Plugin v2.28.0
> **ç”Ÿæˆæ—¥æœŸ**: 2026-01-31

---

## 1. æ ¸å¿ƒæŠ€æœ¯æ¶æ„

### 1.1 æŠ€æœ¯æ ˆæ¦‚è§ˆ

```
Compound Engineering Plugin æŠ€æœ¯æ ˆ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ ç»„ä»¶å®šä¹‰å±‚ (Component Definition Layer)
   â€¢ Markdown (ä»£ç†/å‘½ä»¤/æŠ€èƒ½å®šä¹‰)
   â€¢ YAML Frontmatter (å…ƒæ•°æ®)
   â€¢ JSON (é…ç½®æ–‡ä»¶)

ğŸ”§ CLI å·¥å…·å±‚ (CLI Tool Layer)
   â€¢ TypeScript (ES2022)
   â€¢ Bun Runtime (JavaScript è¿è¡Œæ—¶)
   â€¢ Citty (CLI æ¡†æ¶)

ğŸ”„ è½¬æ¢å¼•æ“å±‚ (Conversion Engine Layer)
   â€¢ Claude Parser (æ’ä»¶è§£æ)
   â€¢ OpenCode Converter (Claude â†’ OpenCode)
   â€¢ Codex Converter (Claude â†’ Codex)
   â€¢ æƒé™æ˜ å°„ç³»ç»Ÿ
   â€¢ Hooks è½¬æ¢ç³»ç»Ÿ

ğŸ¯ å¹³å°é›†æˆå±‚ (Platform Integration Layer)
   â€¢ Claude Code (å®˜æ–¹æ’ä»¶ç³»ç»Ÿ)
   â€¢ OpenCode (ç¤¾åŒºå¹³å°)
   â€¢ Codex (æ›¿ä»£å¹³å°)
   â€¢ MCP Servers (æ¨¡å‹ä¸Šä¸‹æ–‡åè®®)
```

### 1.2 ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å¼€å‘è€… / AI ä»£ç†                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  CLI å‘½ä»¤è¡Œå·¥å…· (Bun)                        â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ convert      â”‚  â”‚ install      â”‚  â”‚ list         â”‚     â”‚
â”‚  â”‚ æ ¼å¼è½¬æ¢     â”‚  â”‚ å®‰è£…è½¬æ¢     â”‚  â”‚ åˆ—å‡ºæ’ä»¶     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚                 â”‚                 â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                 â”‚                 â”‚
          â–¼                 â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æ ¸å¿ƒè½¬æ¢å¼•æ“ (src/)                             â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Parsers (è§£æå™¨)                                      â”‚  â”‚
â”‚  â”‚ â€¢ claude.ts - è§£æ Claude æ’ä»¶ç»“æ„                    â”‚  â”‚
â”‚  â”‚   - æå– YAML frontmatter                           â”‚  â”‚
â”‚  â”‚   - é€’å½’æ‰«æç»„ä»¶ç›®å½•                                 â”‚  â”‚
â”‚  â”‚   - éªŒè¯ç»„ä»¶å®Œæ•´æ€§                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                           â–¼                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Converters (è½¬æ¢å™¨)                                   â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚  â”‚
â”‚  â”‚ â”‚ claude-to-      â”‚    â”‚ claude-to-      â”‚          â”‚  â”‚
â”‚  â”‚ â”‚ opencode.ts     â”‚    â”‚ codex.ts        â”‚          â”‚  â”‚
â”‚  â”‚ â”‚                 â”‚    â”‚                 â”‚          â”‚  â”‚
â”‚  â”‚ â”‚ â€¢ Agent è½¬æ¢    â”‚    â”‚ â€¢ Agent â†’ Skill â”‚          â”‚  â”‚
â”‚  â”‚ â”‚ â€¢ Command è½¬æ¢  â”‚    â”‚ â€¢ Command â†’ Promptâ”‚        â”‚  â”‚
â”‚  â”‚ â”‚ â€¢ Hooks è½¬æ¢    â”‚    â”‚ â€¢ è¯­æ³•è½¬æ¢      â”‚          â”‚  â”‚
â”‚  â”‚ â”‚ â€¢ æƒé™æ˜ å°„      â”‚    â”‚ â€¢ åç§°è§„èŒƒåŒ–    â”‚          â”‚  â”‚
â”‚  â”‚ â”‚ â€¢ æ¸©åº¦æ¨æ–­      â”‚    â”‚ â€¢ å†…å®¹è½¬æ¢      â”‚          â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                           â–¼                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Targets (ç›®æ ‡å¤„ç†å™¨)                                  â”‚  â”‚
â”‚  â”‚ â€¢ opencode.ts - å†™å…¥ OpenCode æ ¼å¼                    â”‚  â”‚
â”‚  â”‚ â€¢ codex.ts - å†™å…¥ Codex æ ¼å¼                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚             â”‚             â”‚
        â–¼             â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Claude   â”‚  â”‚ OpenCode â”‚  â”‚ Codex    â”‚
â”‚ Code     â”‚  â”‚          â”‚  â”‚          â”‚
â”‚ åŸç”Ÿ     â”‚  â”‚ è½¬æ¢å   â”‚  â”‚ è½¬æ¢å   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚             â”‚             â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Compound Engineering Plugin                       â”‚
â”‚                                                             â”‚
â”‚  27 Agents + 20 Commands + 14 Skills                        â”‚
â”‚  å¤åˆå·¥ç¨‹å·¥ä½œæµ + ä¸“ä¸šåŒ–ä»£ç† + çŸ¥è¯†ç®¡ç†                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. CLI å·¥å…·å®ç° (src/)

### 2.1 ç›®å½•ç»“æ„

```
src/
â”œâ”€â”€ index.ts                    # CLI å…¥å£ (å‘½ä»¤æ³¨å†Œ)
â”œâ”€â”€ commands/                   # å‘½ä»¤å®ç° (3 ä¸ª)
â”‚   â”œâ”€â”€ convert.ts              # æ ¼å¼è½¬æ¢å‘½ä»¤
â”‚   â”œâ”€â”€ install.ts              # å®‰è£…è½¬æ¢å‘½ä»¤
â”‚   â””â”€â”€ list.ts                 # åˆ—å‡ºæ’ä»¶å‘½ä»¤
â”‚
â”œâ”€â”€ converters/                 # è½¬æ¢å™¨å®ç° (2 ä¸ª)
â”‚   â”œâ”€â”€ claude-to-opencode.ts   # Claude â†’ OpenCode è½¬æ¢
â”‚   â””â”€â”€ claude-to-codex.ts      # Claude â†’ Codex è½¬æ¢
â”‚
â”œâ”€â”€ parsers/                    # è§£æå™¨å®ç° (1 ä¸ª)
â”‚   â””â”€â”€ claude.ts               # Claude æ’ä»¶è§£æå™¨
â”‚
â”œâ”€â”€ targets/                    # ç›®æ ‡æ ¼å¼å¤„ç†å™¨ (3 ä¸ª)
â”‚   â”œâ”€â”€ index.ts                # ç›®æ ‡æ³¨å†Œè¡¨
â”‚   â”œâ”€â”€ opencode.ts             # OpenCode å†™å…¥å™¨
â”‚   â””â”€â”€ codex.ts                # Codex å†™å…¥å™¨
â”‚
â”œâ”€â”€ types/                      # TypeScript ç±»å‹ (3 ä¸ª)
â”‚   â”œâ”€â”€ claude.ts               # Claude æ’ä»¶ç±»å‹
â”‚   â”œâ”€â”€ opencode.ts             # OpenCode ç±»å‹
â”‚   â””â”€â”€ codex.ts                # Codex ç±»å‹
â”‚
â””â”€â”€ utils/                      # å·¥å…·å‡½æ•° (3 ä¸ª)
    â”œâ”€â”€ files.ts                # æ–‡ä»¶æ“ä½œå·¥å…·
    â”œâ”€â”€ frontmatter.ts          # YAML frontmatter å¤„ç†
    â””â”€â”€ codex-agents.ts         # Codex agents æ–‡ä»¶ç”Ÿæˆ
```

### 2.2 å‘½ä»¤ç³»ç»Ÿå®ç°

#### 2.2.1 convert å‘½ä»¤

**æ–‡ä»¶**: `src/commands/convert.ts`

**ç”¨é€”**: å°† Claude Code æ’ä»¶è½¬æ¢ä¸ºå…¶ä»–å¹³å°æ ¼å¼

**å‘½ä»¤ç­¾å**:

```bash
compound-plugin convert <source> --to <target> [options]
```

**å‚æ•°è¯¦è§£**:

```typescript
{
  source: string                    // å¿…éœ€: Claude æ’ä»¶ç›®å½•è·¯å¾„
  to: "opencode" | "codex"          // ç›®æ ‡æ ¼å¼ (é»˜è®¤: opencode)
  output: string                    // è¾“å‡ºç›®å½• (é»˜è®¤: cwd)
  codexHome: string                 // Codex æ ¹ç›®å½• (é»˜è®¤: ~/.codex)
  also: string                      // é¢å¤–ç›®æ ‡ (é€—å·åˆ†éš”)
  permissions: PermissionMode       // æƒé™æ¨¡å¼ (é»˜è®¤: broad)
  agentMode: "primary" | "subagent" // ä»£ç†æ¨¡å¼ (é»˜è®¤: subagent)
  inferTemperature: boolean         // æ¨æ–­æ¸©åº¦ (é»˜è®¤: true)
}
```

**æ ¸å¿ƒå®ç°**:

```typescript
// 1. è§£æç›®æ ‡æ ¼å¼
const target = targets[targetName]
if (!target || !target.implemented) {
  throw new Error(`Target ${targetName} not available`)
}

// 2. åŠ è½½ Claude æ’ä»¶
const plugin = await loadClaudePlugin(source)

// 3. è½¬æ¢æ’ä»¶
const bundle = target.convert(plugin, {
  agentMode: "subagent",
  inferTemperature: true,
  permissions: "broad"
})

// 4. å†™å…¥æ–‡ä»¶
await target.write(outputRoot, bundle)
```

**æ‰§è¡Œæµç¨‹**:

```
ç”¨æˆ·è¾“å…¥: compound-plugin convert ./plugins/compound-engineering --to opencode
    â†“
éªŒè¯ç›®æ ‡æ ¼å¼
    â†“
åŠ è½½ Claude æ’ä»¶
    â”œâ”€ è¯»å– .claude-plugin/plugin.json
    â”œâ”€ æ‰«æ agents/*.md
    â”œâ”€ æ‰«æ commands/*.md
    â”œâ”€ æ‰«æ skills/*/SKILL.md
    â””â”€ åŠ è½½ hooks/hooks.json
    â†“
è°ƒç”¨è½¬æ¢å™¨
    â”œâ”€ convertClaudeToOpenCode(plugin, options)
    â”‚   â”œâ”€ è½¬æ¢ agents â†’ OpenCode agents
    â”‚   â”œâ”€ è½¬æ¢ commands â†’ OpenCode commands
    â”‚   â”œâ”€ è½¬æ¢ hooks â†’ OpenCode plugin
    â”‚   â””â”€ æ˜ å°„æƒé™ â†’ OpenCode permissions
    â†“
å†™å…¥è¾“å‡º
    â”œâ”€ ~/.config/opencode/opencode.json
    â”œâ”€ ~/.config/opencode/agents/*.md
    â”œâ”€ ~/.config/opencode/skills/* (ç¬¦å·é“¾æ¥)
    â””â”€ ~/.config/opencode/plugins/converted-hooks.ts
    â†“
è¾“å‡ºæˆåŠŸæ¶ˆæ¯
```

**ç¤ºä¾‹è¾“å‡º**:

```bash
$ compound-plugin convert ./plugins/compound-engineering --to opencode

Converted compound-engineering to opencode at /Users/user/.config/opencode
```

---

#### 2.2.2 install å‘½ä»¤

**æ–‡ä»¶**: `src/commands/install.ts`

**ç”¨é€”**: ä» GitHub å®‰è£…å¹¶è½¬æ¢ Claude Code æ’ä»¶

**å‘½ä»¤ç­¾å**:

```bash
compound-plugin install <plugin> --to <target> [options]
```

**å‚æ•°è¯¦è§£**:

```typescript
{
  plugin: string                    // å¿…éœ€: æ’ä»¶åæˆ–è·¯å¾„
  to: "opencode" | "codex"          // ç›®æ ‡æ ¼å¼ (é»˜è®¤: opencode)
  output: string                    // è¾“å‡ºç›®å½•
  codexHome: string                 // Codex æ ¹ç›®å½•
  also: string                      // é¢å¤–ç›®æ ‡
  permissions: PermissionMode       // æƒé™æ¨¡å¼
  agentMode: string                 // ä»£ç†æ¨¡å¼
  inferTemperature: boolean         // æ¨æ–­æ¸©åº¦
}
```

**æ’ä»¶è§£æé€»è¾‘**:

```typescript
async function resolvePluginPath(input: string): Promise<ResolvedPluginPath> {
  // 1. æœ¬åœ°ç»å¯¹è·¯å¾„
  const directPath = path.resolve(input)
  if (await pathExists(directPath)) return { path: directPath }

  // 2. æœ¬åœ° plugins/ ç›®å½•
  const pluginsPath = path.join(process.cwd(), "plugins", input)
  if (await pathExists(pluginsPath)) return { path: pluginsPath }

  // 3. GitHub è¿œç¨‹ä»“åº“
  return await resolveGitHubPluginPath(input)
}
```

**GitHub å…‹éš†æµç¨‹**:

```typescript
async function resolveGitHubPluginPath(pluginName: string): Promise<ResolvedPluginPath> {
  // 1. åˆ›å»ºä¸´æ—¶ç›®å½•
  const tempRoot = await fs.mkdtemp(path.join(os.tmpdir(), "compound-plugin-"))

  // 2. ç¡®å®š GitHub æº
  const source = process.env.COMPOUND_PLUGIN_GITHUB_SOURCE
    ?? "https://github.com/EveryInc/compound-engineering-plugin"

  // 3. å…‹éš†ä»“åº“
  await cloneGitHubRepo(source, tempRoot)

  // 4. éªŒè¯æ’ä»¶å­˜åœ¨
  const pluginPath = path.join(tempRoot, "plugins", pluginName)
  if (!(await pathExists(pluginPath))) {
    throw new Error(`Plugin ${pluginName} not found`)
  }

  // 5. è¿”å›è·¯å¾„å’Œæ¸…ç†å‡½æ•°
  return {
    path: pluginPath,
    cleanup: async () => {
      await fs.rm(tempRoot, { recursive: true, force: true })
    }
  }
}
```

**å®‰è£…æµç¨‹**:

```
ç”¨æˆ·è¾“å…¥: compound-plugin install compound-engineering --to codex
    â†“
è§£ææ’ä»¶è·¯å¾„
    â”œâ”€ æ£€æŸ¥æœ¬åœ°è·¯å¾„
    â”œâ”€ æ£€æŸ¥ plugins/ ç›®å½•
    â””â”€ å…‹éš† GitHub ä»“åº“ (å¦‚æœéœ€è¦)
    â†“
åŠ è½½æ’ä»¶
    â””â”€ loadClaudePlugin(path)
    â†“
è½¬æ¢æ’ä»¶
    â””â”€ target.convert(plugin, options)
    â†“
å†™å…¥æ–‡ä»¶
    â”œâ”€ ~/.codex/prompts/*.md
    â”œâ”€ ~/.codex/skills/*.md
    â””â”€ ~/.codex/skills/* (ç¬¦å·é“¾æ¥)
    â†“
ç”Ÿæˆ agents.md (Codex)
    â””â”€ ensureCodexAgentsFile(~/.codex)
    â†“
æ¸…ç†ä¸´æ—¶æ–‡ä»¶ (å¦‚æœä» GitHub å®‰è£…)
    â†“
è¾“å‡ºæˆåŠŸæ¶ˆæ¯
```

---

#### 2.2.3 list å‘½ä»¤

**æ–‡ä»¶**: `src/commands/list.ts`

**ç”¨é€”**: åˆ—å‡ºå¸‚åœºä¸­å¯ç”¨çš„æ’ä»¶

**å‘½ä»¤ç­¾å**:

```bash
compound-plugin list
```

**å®ç°**:

```typescript
export default defineCommand({
  meta: {
    name: "list",
    description: "List available plugins from the marketplace",
  },
  async run() {
    const marketplace = await loadMarketplace()

    console.log("\nAvailable plugins:\n")
    for (const plugin of marketplace.plugins) {
      console.log(`  ${plugin.name} (v${plugin.version})`)
      console.log(`    ${plugin.description}`)
      console.log(`    Tags: ${plugin.tags.join(", ")}`)
      console.log()
    }
  }
})
```

---

### 2.3 è½¬æ¢å™¨ç³»ç»Ÿå®ç°

#### 2.3.1 Claude â†’ OpenCode è½¬æ¢å™¨

**æ–‡ä»¶**: `src/converters/claude-to-opencode.ts` (393 è¡Œ)

**æ ¸å¿ƒåŠŸèƒ½**:

```
Claude Code æ’ä»¶ â†’ OpenCode Bundle
    â”œâ”€ Agents â†’ OpenCode Agents (frontmatter + markdown)
    â”œâ”€ Commands â†’ OpenCode Commands (config entries)
    â”œâ”€ Hooks â†’ OpenCode Plugin (TypeScript)
    â”œâ”€ MCP Servers â†’ OpenCode MCP Config
    â”œâ”€ Skills â†’ ç¬¦å·é“¾æ¥ (å¤ç”¨åŸå§‹æ–‡ä»¶)
    â””â”€ Permissions â†’ OpenCode Permission Config
```

**ç±»å‹å®šä¹‰**:

```typescript
export type PermissionMode = "none" | "broad" | "from-commands"

export type ClaudeToOpenCodeOptions = {
  agentMode: "primary" | "subagent"
  inferTemperature: boolean
  permissions: PermissionMode
}

export type OpenCodeBundle = {
  config: OpenCodeConfig
  agents: { name: string; content: string }[]
  plugins: { name: string; content: string }[]
  skillDirs: { sourceDir: string; name: string }[]
}
```

**ä¸»è½¬æ¢å‡½æ•°**:

```typescript
export function convertClaudeToOpenCode(
  plugin: ClaudePlugin,
  options: ClaudeToOpenCodeOptions,
): OpenCodeBundle {
  // 1. è½¬æ¢ agents
  const agentFiles = plugin.agents.map((agent) =>
    convertAgent(agent, options)
  )

  // 2. è½¬æ¢ commands
  const commandMap = convertCommands(plugin.commands)

  // 3. è½¬æ¢ MCP servers
  const mcp = plugin.mcpServers
    ? convertMcp(plugin.mcpServers)
    : undefined

  // 4. è½¬æ¢ hooks
  const plugins = plugin.hooks
    ? [convertHooks(plugin.hooks)]
    : []

  // 5. æ„å»ºé…ç½®
  const config: OpenCodeConfig = {
    $schema: "https://opencode.ai/config.json",
    command: commandMap,
    mcp: mcp
  }

  // 6. åº”ç”¨æƒé™æ˜ å°„
  applyPermissions(config, plugin.commands, options.permissions)

  return {
    config,
    agents: agentFiles,
    plugins,
    skillDirs: plugin.skills.map(s => ({
      sourceDir: s.sourceDir,
      name: s.name
    }))
  }
}
```

**Agent è½¬æ¢è¯¦è§£**:

```typescript
function convertAgent(agent: ClaudeAgent, options: ClaudeToOpenCodeOptions) {
  // 1. æ„å»º frontmatter
  const frontmatter: Record<string, unknown> = {
    description: agent.description,
    mode: options.agentMode  // "primary" or "subagent"
  }

  // 2. æ¨¡å‹å½’ä¸€åŒ–
  if (agent.model && agent.model !== "inherit") {
    frontmatter.model = normalizeModel(agent.model)
    // claude-opus-4 â†’ anthropic/claude-opus-4
    // gpt-4 â†’ openai/gpt-4
  }

  // 3. æ¸©åº¦æ¨æ–­
  if (options.inferTemperature) {
    const temperature = inferTemperature(agent)
    if (temperature !== undefined) {
      frontmatter.temperature = temperature
    }
  }

  // 4. æ ¼å¼åŒ–è¾“å‡º
  const content = formatFrontmatter(frontmatter, agent.body)

  return {
    name: agent.name,
    content
  }
}
```

**æ¸©åº¦æ¨æ–­é€»è¾‘**:

```typescript
function inferTemperature(agent: ClaudeAgent): number | undefined {
  const sample = `${agent.name} ${agent.description ?? ""}`.toLowerCase()

  // å®¡æŸ¥ç±»ä»£ç† (é«˜ç²¾ç¡®åº¦)
  if (/(review|audit|security|sentinel|oracle|lint|verification|guardian)/.test(sample)) {
    return 0.1
  }

  // è§„åˆ’ç±»ä»£ç† (ä¸­ä½æ¸©åº¦)
  if (/(plan|planning|architecture|strategist|analysis|research)/.test(sample)) {
    return 0.2
  }

  // æ–‡æ¡£ç±»ä»£ç† (ä¸­æ¸©åº¦)
  if (/(doc|readme|changelog|editor|writer)/.test(sample)) {
    return 0.3
  }

  // åˆ›æ„ç±»ä»£ç† (é«˜æ¸©åº¦)
  if (/(brainstorm|creative|ideate|design|concept)/.test(sample)) {
    return 0.6
  }

  // é»˜è®¤æ¸©åº¦
  return 0.3
}
```

**Hooks è½¬æ¢è¯¦è§£**:

```typescript
function convertHooks(hooks: ClaudeHooks) {
  const handlerBlocks: string[] = []
  const unmappedEvents: string[] = []

  // Claude â†’ OpenCode äº‹ä»¶æ˜ å°„
  const HOOK_EVENT_MAP = {
    SessionStart: { events: ["session.created"], type: "session" },
    PreToolUse: { events: ["tool.execute.before"], type: "tool" },
    PostToolUse: { events: ["tool.execute.after"], type: "tool" },
    // ... æ›´å¤šæ˜ å°„
  }

  // è½¬æ¢æ¯ä¸ª hook
  for (const [eventName, matchers] of Object.entries(hooks.hooks)) {
    const mapping = HOOK_EVENT_MAP[eventName]
    if (!mapping) {
      unmappedEvents.push(eventName)
      continue
    }

    for (const event of mapping.events) {
      handlerBlocks.push(
        renderHookHandlers(event, matchers, {
          useToolMatcher: mapping.type === "tool",
          requireError: mapping.requireError ?? false
        })
      )
    }
  }

  // ç”Ÿæˆ TypeScript æ’ä»¶ä»£ç 
  const content = `
import type { Plugin } from "@opencode-ai/plugin"

export const ConvertedHooks: Plugin = async ({ $ }) => {
  return {
${handlerBlocks.join(",\n")}
  }
}

export default ConvertedHooks
`

  return {
    name: "converted-hooks.ts",
    content
  }
}
```

**æƒé™æ˜ å°„ç³»ç»Ÿ**:

```typescript
function applyPermissions(
  config: OpenCodeConfig,
  commands: ClaudeCommand[],
  mode: PermissionMode
) {
  if (mode === "none") return

  const sourceTools = [
    "read", "write", "edit", "bash", "grep", "glob",
    "list", "webfetch", "skill", "patch", "task",
    "question", "todowrite", "todoread"
  ]

  let enabled = new Set<string>()
  const patterns: Record<string, Set<string>> = {}

  if (mode === "broad") {
    // å¹¿æ³›æ¨¡å¼: å¯ç”¨æ‰€æœ‰å·¥å…·
    enabled = new Set(sourceTools)
  } else {
    // from-commands æ¨¡å¼: ä»å‘½ä»¤æå–æƒé™
    for (const command of commands) {
      if (!command.allowedTools) continue
      for (const tool of command.allowedTools) {
        const parsed = parseToolSpec(tool)
        if (!parsed.tool) continue
        enabled.add(parsed.tool)

        // å¤„ç†æ¨¡å¼åŒ¹é… (å¦‚ "read(docs/*)")
        if (parsed.pattern) {
          if (!patterns[parsed.tool]) patterns[parsed.tool] = new Set()
          patterns[parsed.tool].add(parsed.pattern)
        }
      }
    }
  }

  // æ„å»ºæƒé™é…ç½®
  const permission: Record<string, "allow" | "deny" | Record<string, "allow" | "deny">> = {}

  for (const tool of sourceTools) {
    const toolPatterns = patterns[tool]
    if (toolPatterns && toolPatterns.size > 0) {
      // æ¨¡å¼åŒ¹é…æƒé™
      const patternPermission: Record<string, "allow" | "deny"> = { "*": "deny" }
      for (const pattern of toolPatterns) {
        patternPermission[pattern] = "allow"
      }
      permission[tool] = patternPermission
    } else {
      // ç®€å•æƒé™
      permission[tool] = enabled.has(tool) ? "allow" : "deny"
    }
  }

  // ç‰¹æ®Šå¤„ç†: write å’Œ edit äº’ç›¸å¯ç”¨
  if (enabled.has("write") || enabled.has("edit")) {
    if (typeof permission.edit === "string") permission.edit = "allow"
    if (typeof permission.write === "string") permission.write = "allow"
  }

  config.permission = permission
  config.tools = Object.fromEntries(
    sourceTools.map(tool => [tool, enabled.has(tool)])
  )
}
```

**æƒé™æ¨¡å¼å¯¹æ¯”**:

```yaml
none (æ— æƒé™):
  tools: å…¨éƒ¨å…³é—­
  permission: æœªå®šä¹‰
  ç”¨é€”: æœ€å°æƒé™åœºæ™¯

broad (å¹¿æ³›æƒé™):
  tools: å…¨éƒ¨å¯ç”¨
  permission: å…¨éƒ¨ allow
  ç”¨é€”: å¿«é€Ÿå¼€å‘ã€ä¿¡ä»»ç¯å¢ƒ

from-commands (å‘½ä»¤æƒé™):
  tools: æŒ‰éœ€å¯ç”¨
  permission: åŸºäºå‘½ä»¤çš„ allowed-tools
  ç”¨é€”: ç”Ÿäº§ç¯å¢ƒã€å®‰å…¨ç¬¬ä¸€
```

---

#### 2.3.2 Claude â†’ Codex è½¬æ¢å™¨

**æ–‡ä»¶**: `src/converters/claude-to-codex.ts` (182 è¡Œ)

**æ ¸å¿ƒåŠŸèƒ½**:

```
Claude Code æ’ä»¶ â†’ Codex Bundle
    â”œâ”€ Agents â†’ Codex Skills (SKILL.md)
    â”œâ”€ Commands â†’ Codex Prompts (prompt.md) + Skills
    â”œâ”€ Skills â†’ ç¬¦å·é“¾æ¥ (å¤ç”¨åŸå§‹æ–‡ä»¶)
    â””â”€ è¯­æ³•è½¬æ¢ (Task â†’ skill è°ƒç”¨)
```

**ç±»å‹å®šä¹‰**:

```typescript
export type CodexBundle = {
  prompts: { name: string; content: string }[]
  skillDirs: { name: string; sourceDir: string }[]
  generatedSkills: { name: string; content: string }[]
  mcpServers?: Record<string, ClaudeMcpServer>
}
```

**ä¸»è½¬æ¢å‡½æ•°**:

```typescript
export function convertClaudeToCodex(
  plugin: ClaudePlugin,
  _options: ClaudeToCodexOptions
): CodexBundle {
  const promptNames = new Set<string>()
  const usedSkillNames = new Set<string>()

  // 1. æŠ€èƒ½ç›®å½• (ç›´æ¥å¤ç”¨)
  const skillDirs = plugin.skills.map(skill => ({
    name: skill.name,
    sourceDir: skill.sourceDir
  }))
  skillDirs.forEach(skill => usedSkillNames.add(normalizeName(skill.name)))

  // 2. å‘½ä»¤ â†’ æç¤ºè¯ + æŠ€èƒ½
  const commandSkills: CodexGeneratedSkill[] = []
  const prompts = plugin.commands.map(command => {
    const promptName = uniqueName(normalizeName(command.name), promptNames)
    const commandSkill = convertCommandSkill(command, usedSkillNames)
    commandSkills.push(commandSkill)
    const content = renderPrompt(command, commandSkill.name)
    return { name: promptName, content }
  })

  // 3. ä»£ç† â†’ æŠ€èƒ½
  const agentSkills = plugin.agents.map(agent =>
    convertAgent(agent, usedSkillNames)
  )

  return {
    prompts,
    skillDirs,
    generatedSkills: [...commandSkills, ...agentSkills],
    mcpServers: plugin.mcpServers
  }
}
```

**Agent â†’ Skill è½¬æ¢**:

```typescript
function convertAgent(agent: ClaudeAgent, usedNames: Set<string>): CodexGeneratedSkill {
  const name = uniqueName(normalizeName(agent.name), usedNames)
  const description = sanitizeDescription(
    agent.description ?? `Converted from Claude agent ${agent.name}`
  )

  // æ„å»º frontmatter
  const frontmatter: Record<string, unknown> = { name, description }

  // æ„å»º body (åŒ…å« capabilities)
  let body = agent.body.trim()
  if (agent.capabilities && agent.capabilities.length > 0) {
    const capabilities = agent.capabilities
      .map(cap => `- ${cap}`)
      .join("\n")
    body = `## Capabilities\n${capabilities}\n\n${body}`.trim()
  }

  const content = formatFrontmatter(frontmatter, body)

  return { name, content }
}
```

**è¯­æ³•è½¬æ¢ç³»ç»Ÿ**:

Codex å’Œ Claude Code æœ‰ä¸åŒçš„è¯­æ³•çº¦å®š,è½¬æ¢å™¨éœ€è¦è½¬æ¢:

```typescript
function transformContentForCodex(body: string): string {
  let result = body

  // 1. Task ä»£ç†è°ƒç”¨ â†’ Skill å¼•ç”¨
  // Claude: Task repo-research-analyst(feature_description)
  // Codex:  Use the $repo-research-analyst skill to: feature_description
  const taskPattern = /^(\s*-?\s*)Task\s+([a-z][a-z0-9-]*)\(([^)]+)\)/gm
  result = result.replace(
    taskPattern,
    (_match, prefix: string, agentName: string, args: string) => {
      const skillName = normalizeName(agentName)
      const trimmedArgs = args.trim()
      return `${prefix}Use the $${skillName} skill to: ${trimmedArgs}`
    }
  )

  // 2. æ–œæ å‘½ä»¤ â†’ æç¤ºè¯å¼•ç”¨
  // Claude: /workflows:brainstorm
  // Codex:  /prompts:workflows-brainstorm
  const slashCommandPattern = /(?<![:\w])\/([a-z][a-z0-9_:-]*?)(?=[\s,."')\]}`]|$)/gi
  result = result.replace(slashCommandPattern, (match, commandName: string) => {
    // è·³è¿‡æ–‡ä»¶è·¯å¾„
    if (commandName.includes('/')) return match
    // è·³è¿‡å¸¸è§ç›®å½•
    if (['dev', 'tmp', 'etc', 'usr'].includes(commandName)) return match
    // è½¬æ¢ä¸º Codex æç¤ºè¯
    const normalizedName = normalizeName(commandName)
    return `/prompts:${normalizedName}`
  })

  // 3. @agent-name â†’ $skill-name skill
  // Claude: @code-reviewer
  // Codex:  $code-reviewer skill
  const agentRefPattern = /@([a-z][a-z0-9-]*-(?:agent|reviewer|researcher|analyst))/gi
  result = result.replace(agentRefPattern, (_match, agentName: string) => {
    const skillName = normalizeName(agentName)
    return `$${skillName} skill`
  })

  return result
}
```

**è¯­æ³•è½¬æ¢ç¤ºä¾‹**:

```markdown
## Claude Code æ ¼å¼ (è¾“å…¥)

Phase 1: Research
   - Task repo-research-analyst(analyze current architecture)
   - Run /workflows:brainstorm to explore options
   - Consult @security-reviewer for security aspects

## Codex æ ¼å¼ (è¾“å‡º)

Phase 1: Research
   - Use the $repo-research-analyst skill to: analyze current architecture
   - Run /prompts:workflows-brainstorm to explore options
   - Consult $security-reviewer skill for security aspects
```

**åç§°è§„èŒƒåŒ–**:

```typescript
function normalizeName(value: string): string {
  const trimmed = value.trim()
  if (!trimmed) return "item"

  const normalized = trimmed
    .toLowerCase()
    .replace(/[\\/]+/g, "-")        // è·¯å¾„åˆ†éš”ç¬¦ â†’ è¿å­—ç¬¦
    .replace(/[:\s]+/g, "-")        // å†’å·/ç©ºæ ¼ â†’ è¿å­—ç¬¦
    .replace(/[^a-z0-9_-]+/g, "-")  // éæ³•å­—ç¬¦ â†’ è¿å­—ç¬¦
    .replace(/-+/g, "-")            // å¤šä¸ªè¿å­—ç¬¦ â†’ å•ä¸ª
    .replace(/^-+|-+$/g, "")        // å»é™¤é¦–å°¾è¿å­—ç¬¦

  return normalized || "item"
}
```

**åç§°è§„èŒƒåŒ–ç¤ºä¾‹**:

```typescript
normalizeName("workflows:brainstorm")   // â†’ "workflows-brainstorm"
normalizeName("repo-research-analyst")  // â†’ "repo-research-analyst"
normalizeName("Code Reviewer")          // â†’ "code-reviewer"
normalizeName("API/Design")             // â†’ "api-design"
```

---

### 2.4 è§£æå™¨ç³»ç»Ÿå®ç°

#### 2.4.1 Claude æ’ä»¶è§£æå™¨

**æ–‡ä»¶**: `src/parsers/claude.ts` (249 è¡Œ)

**æ ¸å¿ƒåŠŸèƒ½**:

```
Claude æ’ä»¶ç›®å½• â†’ ClaudePlugin å¯¹è±¡
    â”œâ”€ è§£æ plugin.json å…ƒæ•°æ®
    â”œâ”€ æ‰«æ agents/ ç›®å½•
    â”œâ”€ æ‰«æ commands/ ç›®å½•
    â”œâ”€ æ‰«æ skills/ ç›®å½•
    â”œâ”€ åŠ è½½ hooks/hooks.json
    â””â”€ åŠ è½½ MCP server é…ç½®
```

**ä¸»å‡½æ•°**:

```typescript
export async function loadClaudePlugin(inputPath: string): Promise<ClaudePlugin> {
  // 1. è§£ææ ¹ç›®å½•
  const root = await resolveClaudeRoot(inputPath)

  // 2. è¯»å–å…ƒæ•°æ®
  const manifestPath = path.join(root, ".claude-plugin", "plugin.json")
  const manifest = await readJson<ClaudeManifest>(manifestPath)

  // 3. åŠ è½½ç»„ä»¶
  const agents = await loadAgents(
    resolveComponentDirs(root, "agents", manifest.agents)
  )
  const commands = await loadCommands(
    resolveComponentDirs(root, "commands", manifest.commands)
  )
  const skills = await loadSkills(
    resolveComponentDirs(root, "skills", manifest.skills)
  )
  const hooks = await loadHooks(root, manifest.hooks)
  const mcpServers = await loadMcpServers(root, manifest)

  return {
    root,
    manifest,
    agents,
    commands,
    skills,
    hooks,
    mcpServers
  }
}
```

**æ ¹ç›®å½•è§£æ**:

```typescript
async function resolveClaudeRoot(inputPath: string): Promise<string> {
  const absolute = path.resolve(inputPath)

  // 1. ç›®å½•æœ¬èº«åŒ…å« .claude-plugin/plugin.json
  const manifestAtPath = path.join(absolute, ".claude-plugin", "plugin.json")
  if (await pathExists(manifestAtPath)) {
    return absolute
  }

  // 2. è¾“å…¥è·¯å¾„æ˜¯ plugin.json æ–‡ä»¶
  if (absolute.endsWith(".claude-plugin/plugin.json") ||
      absolute.endsWith("plugin.json")) {
    return path.dirname(path.dirname(absolute))
  }

  throw new Error(`Could not find .claude-plugin/plugin.json under ${inputPath}`)
}
```

**ç»„ä»¶åŠ è½½æµç¨‹**:

```typescript
// 1. è§£æç»„ä»¶ç›®å½• (æ”¯æŒè‡ªå®šä¹‰è·¯å¾„)
function resolveComponentDirs(
  root: string,
  defaultDir: string,
  custom?: string | string[]
): string[] {
  const dirs = [path.join(root, defaultDir)]  // é»˜è®¤ç›®å½•

  // æ·»åŠ è‡ªå®šä¹‰ç›®å½• (æ¥è‡ª plugin.json)
  for (const entry of toPathList(custom)) {
    dirs.push(resolveWithinRoot(root, entry, `${defaultDir} path`))
  }

  return dirs
}

// 2. åŠ è½½ Agents
async function loadAgents(agentsDirs: string[]): Promise<ClaudeAgent[]> {
  const files = await collectMarkdownFiles(agentsDirs)

  const agents: ClaudeAgent[] = []
  for (const file of files) {
    const raw = await readText(file)
    const { data, body } = parseFrontmatter(raw)

    const name = (data.name as string) ?? path.basename(file, ".md")
    agents.push({
      name,
      description: data.description as string | undefined,
      capabilities: data.capabilities as string[] | undefined,
      model: data.model as string | undefined,
      body: body.trim(),
      sourcePath: file
    })
  }

  return agents
}

// 3. åŠ è½½ Commands
async function loadCommands(commandsDirs: string[]): Promise<ClaudeCommand[]> {
  const files = await collectMarkdownFiles(commandsDirs)

  const commands: ClaudeCommand[] = []
  for (const file of files) {
    const raw = await readText(file)
    const { data, body } = parseFrontmatter(raw)

    const name = (data.name as string) ?? path.basename(file, ".md")
    const allowedTools = parseAllowedTools(data["allowed-tools"])

    commands.push({
      name,
      description: data.description as string | undefined,
      argumentHint: data["argument-hint"] as string | undefined,
      model: data.model as string | undefined,
      allowedTools,
      body: body.trim(),
      sourcePath: file
    })
  }

  return commands
}

// 4. åŠ è½½ Skills
async function loadSkills(skillsDirs: string[]): Promise<ClaudeSkill[]> {
  const entries = await collectFiles(skillsDirs)
  const skillFiles = entries.filter(file =>
    path.basename(file) === "SKILL.md"
  )

  const skills: ClaudeSkill[] = []
  for (const file of skillFiles) {
    const raw = await readText(file)
    const { data } = parseFrontmatter(raw)

    const name = (data.name as string) ?? path.basename(path.dirname(file))
    skills.push({
      name,
      description: data.description as string | undefined,
      sourceDir: path.dirname(file),
      skillPath: file
    })
  }

  return skills
}
```

**Frontmatter è§£æ**:

```typescript
// æ–‡ä»¶: src/utils/frontmatter.ts

export function parseFrontmatter(content: string): {
  data: Record<string, unknown>
  body: string
} {
  // åŒ¹é… YAML frontmatter (---...---)
  const frontmatterRegex = /^---\n([\s\S]*?)\n---\n/
  const match = content.match(frontmatterRegex)

  if (!match) {
    return { data: {}, body: content }
  }

  // æå– YAML å’Œ body
  const yamlText = match[1]
  const body = content.slice(match[0].length)

  // è§£æ YAML (ç®€å•å®ç°)
  const data: Record<string, unknown> = {}
  const lines = yamlText.split("\n")

  for (const line of lines) {
    const [key, ...valueParts] = line.split(":")
    if (key && valueParts.length > 0) {
      const value = valueParts.join(":").trim()

      // å¤„ç†æ•°ç»„ (å¦‚ capabilities)
      if (value.startsWith("[") && value.endsWith("]")) {
        const items = value.slice(1, -1).split(",")
        data[key.trim()] = items.map(item => item.trim())
      } else {
        data[key.trim()] = value
      }
    }
  }

  return { data, body }
}
```

---

### 2.5 ç›®æ ‡å¤„ç†å™¨ç³»ç»Ÿ

#### 2.5.1 OpenCode ç›®æ ‡å¤„ç†å™¨

**æ–‡ä»¶**: `src/targets/opencode.ts`

**æ ¸å¿ƒåŠŸèƒ½**:

```
OpenCodeBundle â†’ æ–‡ä»¶ç³»ç»Ÿ
    â”œâ”€ å†™å…¥ opencode.json (æ ¹é…ç½®)
    â”œâ”€ å†™å…¥ agents/*.md (ä»£ç†æ–‡ä»¶)
    â”œâ”€ å†™å…¥ plugins/*.ts (hooks æ’ä»¶)
    â””â”€ åˆ›å»º skills/* ç¬¦å·é“¾æ¥
```

**å®ç°**:

```typescript
export const opencode: Target = {
  name: "opencode",
  implemented: true,

  convert(plugin: ClaudePlugin, options: unknown): unknown {
    return convertClaudeToOpenCode(
      plugin,
      options as ClaudeToOpenCodeOptions
    )
  },

  async write(root: string, data: unknown): Promise<void> {
    const bundle = data as OpenCodeBundle

    // 1. ç¡®ä¿ç›®å½•å­˜åœ¨
    await ensureDir(root)
    await ensureDir(path.join(root, "agents"))
    await ensureDir(path.join(root, "skills"))
    await ensureDir(path.join(root, "plugins"))

    // 2. å†™å…¥é…ç½®æ–‡ä»¶
    const configPath = path.join(root, "opencode.json")
    await writeJson(configPath, bundle.config)

    // 3. å†™å…¥ agents
    for (const agent of bundle.agents) {
      const agentPath = path.join(root, "agents", `${agent.name}.md`)
      await writeText(agentPath, agent.content)
    }

    // 4. å†™å…¥ plugins
    for (const plugin of bundle.plugins) {
      const pluginPath = path.join(root, "plugins", plugin.name)
      await writeText(pluginPath, plugin.content)
    }

    // 5. åˆ›å»º skills ç¬¦å·é“¾æ¥
    for (const skill of bundle.skillDirs) {
      const linkPath = path.join(root, "skills", skill.name)
      const targetPath = skill.sourceDir

      // åˆ é™¤æ—§é“¾æ¥
      if (await pathExists(linkPath)) {
        await fs.unlink(linkPath)
      }

      // åˆ›å»ºç¬¦å·é“¾æ¥
      await fs.symlink(targetPath, linkPath, "dir")
    }
  }
}
```

**è¾“å‡ºç»“æ„**:

```
~/.config/opencode/
â”œâ”€â”€ opencode.json                 # æ ¹é…ç½®
â”‚   â”œâ”€â”€ $schema
â”‚   â”œâ”€â”€ command: { ... }          # å‘½ä»¤é…ç½®
â”‚   â”œâ”€â”€ mcp: { ... }              # MCP servers
â”‚   â”œâ”€â”€ permission: { ... }       # æƒé™é…ç½®
â”‚   â””â”€â”€ tools: { ... }            # å·¥å…·å¯ç”¨çŠ¶æ€
â”‚
â”œâ”€â”€ agents/                       # ä»£ç†ç›®å½•
â”‚   â”œâ”€â”€ kieran-rails-reviewer.md
â”‚   â”œâ”€â”€ python-code-reviewer.md
â”‚   â”œâ”€â”€ typescript-code-reviewer.md
â”‚   â””â”€â”€ ... (27 ä¸ª)
â”‚
â”œâ”€â”€ skills/                       # æŠ€èƒ½ç›®å½• (ç¬¦å·é“¾æ¥)
â”‚   â”œâ”€â”€ agent-native-architecture/ â†’ åŸå§‹ç›®å½•
â”‚   â”œâ”€â”€ dhh-rails-style/ â†’ åŸå§‹ç›®å½•
â”‚   â””â”€â”€ ... (14 ä¸ª)
â”‚
â””â”€â”€ plugins/                      # æ’ä»¶ç›®å½•
    â””â”€â”€ converted-hooks.ts        # Hooks æ’ä»¶
```

---

#### 2.5.2 Codex ç›®æ ‡å¤„ç†å™¨

**æ–‡ä»¶**: `src/targets/codex.ts`

**æ ¸å¿ƒåŠŸèƒ½**:

```
CodexBundle â†’ æ–‡ä»¶ç³»ç»Ÿ
    â”œâ”€ å†™å…¥ prompts/*.md (æç¤ºè¯æ–‡ä»¶)
    â”œâ”€ å†™å…¥ skills/*.md (ç”Ÿæˆçš„æŠ€èƒ½)
    â”œâ”€ åˆ›å»º skills/* ç¬¦å·é“¾æ¥ (åŸå§‹æŠ€èƒ½)
    â””â”€ ç”Ÿæˆ agents.md (ä»£ç†åˆ—è¡¨)
```

**å®ç°**:

```typescript
export const codex: Target = {
  name: "codex",
  implemented: true,

  convert(plugin: ClaudePlugin, options: unknown): unknown {
    return convertClaudeToCodex(
      plugin,
      options as ClaudeToCodexOptions
    )
  },

  async write(root: string, data: unknown): Promise<void> {
    const bundle = data as CodexBundle

    // 1. ç¡®ä¿ç›®å½•å­˜åœ¨
    await ensureDir(root)
    await ensureDir(path.join(root, "prompts"))
    await ensureDir(path.join(root, "skills"))

    // 2. å†™å…¥ prompts (å‘½ä»¤ â†’ æç¤ºè¯)
    for (const prompt of bundle.prompts) {
      const promptPath = path.join(root, "prompts", `${prompt.name}.md`)
      await writeText(promptPath, prompt.content)
    }

    // 3. å†™å…¥ç”Ÿæˆçš„ skills (ä»£ç† â†’ æŠ€èƒ½)
    for (const skill of bundle.generatedSkills) {
      const skillPath = path.join(root, "skills", `${skill.name}.md`)
      await writeText(skillPath, skill.content)
    }

    // 4. åˆ›å»º skills ç¬¦å·é“¾æ¥ (åŸå§‹æŠ€èƒ½)
    for (const skillDir of bundle.skillDirs) {
      const linkPath = path.join(root, "skills", skillDir.name)
      const targetPath = skillDir.sourceDir

      if (await pathExists(linkPath)) {
        await fs.unlink(linkPath)
      }

      await fs.symlink(targetPath, linkPath, "dir")
    }

    // 5. å†™å…¥ MCP servers (å¦‚æœæœ‰)
    if (bundle.mcpServers) {
      const mcpPath = path.join(root, ".mcp.json")
      await writeJson(mcpPath, bundle.mcpServers)
    }
  }
}
```

**agents.md ç”Ÿæˆ**:

```typescript
// æ–‡ä»¶: src/utils/codex-agents.ts

export async function ensureCodexAgentsFile(codexRoot: string): Promise<void> {
  const agentsPath = path.join(codexRoot, "agents.md")

  // æ‰«ææ‰€æœ‰ç”Ÿæˆçš„æŠ€èƒ½ (ä»ä»£ç†è½¬æ¢æ¥çš„)
  const skillsDir = path.join(codexRoot, "skills")
  const skillFiles = await collectMarkdownFiles([skillsDir])

  const skills: { name: string; description: string }[] = []
  for (const file of skillFiles) {
    const raw = await readText(file)
    const { data } = parseFrontmatter(raw)

    const name = (data.name as string) ?? path.basename(file, ".md")
    const description = (data.description as string) ?? ""

    skills.push({ name, description })
  }

  // ç”Ÿæˆ agents.md å†…å®¹
  const content = `# Available Agents

The following agents are available as skills in Codex:

${skills.map(skill => `- **${skill.name}**: ${skill.description}`).join("\n")}

## Usage

To use an agent, invoke it as a skill:

\`\`\`
Use the $${skills[0]?.name ?? "agent-name"} skill to: [your request]
\`\`\`
`

  await writeText(agentsPath, content)
}
```

**è¾“å‡ºç»“æ„**:

```
~/.codex/
â”œâ”€â”€ prompts/                      # æç¤ºè¯ç›®å½• (ä»å‘½ä»¤è½¬æ¢)
â”‚   â”œâ”€â”€ workflows-brainstorm.md
â”‚   â”œâ”€â”€ workflows-plan.md
â”‚   â”œâ”€â”€ workflows-review.md
â”‚   â””â”€â”€ ... (20 ä¸ª)
â”‚
â”œâ”€â”€ skills/                       # æŠ€èƒ½ç›®å½•
â”‚   â”œâ”€â”€ kieran-rails-reviewer.md  # ç”Ÿæˆçš„ (ä»ä»£ç†è½¬æ¢)
â”‚   â”œâ”€â”€ python-code-reviewer.md   # ç”Ÿæˆçš„
â”‚   â”œâ”€â”€ agent-native-architecture/ â†’ ç¬¦å·é“¾æ¥ (åŸå§‹æŠ€èƒ½)
â”‚   â”œâ”€â”€ dhh-rails-style/ â†’ ç¬¦å·é“¾æ¥
â”‚   â””â”€â”€ ... (27 ä¸ªç”Ÿæˆ + 14 ä¸ªç¬¦å·é“¾æ¥)
â”‚
â”œâ”€â”€ agents.md                     # ä»£ç†åˆ—è¡¨æ–‡æ¡£
â””â”€â”€ .mcp.json                     # MCP servers é…ç½® (å¦‚æœæœ‰)
```

---

### 2.6 ç±»å‹ç³»ç»Ÿè¯¦è§£

#### 2.6.1 Claude æ’ä»¶ç±»å‹

**æ–‡ä»¶**: `src/types/claude.ts` (89 è¡Œ)

**æ ¸å¿ƒç±»å‹**:

```typescript
// æ’ä»¶å…ƒæ•°æ®
export type ClaudeManifest = {
  name: string
  version: string
  description?: string
  author?: {
    name?: string
    email?: string
    url?: string
  }
  keywords?: string[]
  agents?: string | string[]      // å¯è‡ªå®šä¹‰ç›®å½•
  commands?: string | string[]    // å¯è‡ªå®šä¹‰ç›®å½•
  skills?: string | string[]      // å¯è‡ªå®šä¹‰ç›®å½•
  hooks?: string | string[] | ClaudeHooks
  mcpServers?: Record<string, ClaudeMcpServer> | string | string[]
}

// ä»£ç†å®šä¹‰
export type ClaudeAgent = {
  name: string
  description?: string
  capabilities?: string[]
  model?: string                  // æ¨¡å‹è¦†ç›– (å¦‚ "claude-opus-4")
  body: string                    // Markdown å†…å®¹
  sourcePath: string              // åŸå§‹æ–‡ä»¶è·¯å¾„
}

// å‘½ä»¤å®šä¹‰
export type ClaudeCommand = {
  name: string
  description?: string
  argumentHint?: string           // å‚æ•°æç¤º
  model?: string                  // æ¨¡å‹è¦†ç›–
  allowedTools?: string[]         // å…è®¸çš„å·¥å…· (ç”¨äºæƒé™æ˜ å°„)
  body: string                    // Markdown å†…å®¹
  sourcePath: string
}

// æŠ€èƒ½å®šä¹‰
export type ClaudeSkill = {
  name: string
  description?: string
  sourceDir: string               // æŠ€èƒ½ç›®å½• (åŒ…å« SKILL.md)
  skillPath: string               // SKILL.md è·¯å¾„
}

// Hooks å®šä¹‰
export type ClaudeHookEntry =
  | { type: "command"; command: string; timeout?: number }
  | { type: "prompt"; prompt: string }
  | { type: "agent"; agent: string }

export type ClaudeHookMatcher = {
  matcher: string                 // åŒ¹é…å™¨ (å¦‚ "startup|resume")
  hooks: ClaudeHookEntry[]
}

export type ClaudeHooks = {
  hooks: Record<string, ClaudeHookMatcher[]>
  // å¦‚: { "SessionStart": [{ matcher: "startup", hooks: [...] }] }
}

// MCP Server å®šä¹‰
export type ClaudeMcpServer = {
  type?: string
  command?: string                // æœ¬åœ°å‘½ä»¤
  args?: string[]                 // å‘½ä»¤å‚æ•°
  url?: string                    // è¿œç¨‹ URL
  env?: Record<string, string>    // ç¯å¢ƒå˜é‡
  headers?: Record<string, string> // HTTP headers
}

// å®Œæ•´æ’ä»¶
export type ClaudePlugin = {
  root: string                    // æ’ä»¶æ ¹ç›®å½•
  manifest: ClaudeManifest        // å…ƒæ•°æ®
  agents: ClaudeAgent[]           // ä»£ç†åˆ—è¡¨
  commands: ClaudeCommand[]       // å‘½ä»¤åˆ—è¡¨
  skills: ClaudeSkill[]           // æŠ€èƒ½åˆ—è¡¨
  hooks?: ClaudeHooks             // Hooks é…ç½®
  mcpServers?: Record<string, ClaudeMcpServer>
}
```

---

#### 2.6.2 OpenCode ç±»å‹

**æ–‡ä»¶**: `src/types/opencode.ts`

**æ ¸å¿ƒç±»å‹**:

```typescript
// OpenCode é…ç½®æ–‡ä»¶
export type OpenCodeConfig = {
  $schema: string
  command?: Record<string, OpenCodeCommandConfig>
  mcp?: Record<string, OpenCodeMcpServer>
  permission?: Record<string, "allow" | "deny" | Record<string, "allow" | "deny">>
  tools?: Record<string, boolean>
}

// å‘½ä»¤é…ç½®
export type OpenCodeCommandConfig = {
  description?: string
  template: string                // å‘½ä»¤æ¨¡æ¿ (Markdown)
  model?: string                  // æ¨¡å‹è¦†ç›–
}

// MCP Server é…ç½®
export type OpenCodeMcpServer =
  | {
      type: "local"
      command: string[]
      environment?: Record<string, string>
      enabled: boolean
    }
  | {
      type: "remote"
      url: string
      headers?: Record<string, string>
      enabled: boolean
    }

// è½¬æ¢åçš„ Bundle
export type OpenCodeBundle = {
  config: OpenCodeConfig          // opencode.json
  agents: {                       // agents/*.md
    name: string
    content: string
  }[]
  plugins: {                      // plugins/*.ts
    name: string
    content: string
  }[]
  skillDirs: {                    // skills/* (ç¬¦å·é“¾æ¥)
    sourceDir: string
    name: string
  }[]
}
```

---

#### 2.6.3 Codex ç±»å‹

**æ–‡ä»¶**: `src/types/codex.ts`

**æ ¸å¿ƒç±»å‹**:

```typescript
// ç”Ÿæˆçš„æŠ€èƒ½ (ä»ä»£ç†æˆ–å‘½ä»¤è½¬æ¢)
export type CodexGeneratedSkill = {
  name: string
  content: string                 // SKILL.md æ ¼å¼å†…å®¹
}

// è½¬æ¢åçš„ Bundle
export type CodexBundle = {
  prompts: {                      // prompts/*.md (ä»å‘½ä»¤è½¬æ¢)
    name: string
    content: string
  }[]
  skillDirs: {                    // skills/* (ç¬¦å·é“¾æ¥,åŸå§‹æŠ€èƒ½)
    name: string
    sourceDir: string
  }[]
  generatedSkills: CodexGeneratedSkill[]  // skills/*.md (ç”Ÿæˆçš„æŠ€èƒ½)
  mcpServers?: Record<string, ClaudeMcpServer>
}
```

---

## 3. æƒé™æ˜ å°„ç³»ç»Ÿ

### 3.1 æƒé™æ¨¡å¼è¯¦è§£

Compound Engineering Plugin æ”¯æŒ 3 ç§æƒé™æ˜ å°„æ¨¡å¼,é€‚åº”ä¸åŒå®‰å…¨éœ€æ±‚:

```yaml
æƒé™æ¨¡å¼å¯¹æ¯”:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

none (æ— æƒé™):
  æè¿°: å…³é—­æ‰€æœ‰å·¥å…·å’Œæƒé™
  é…ç½®:
    tools: { bash: false, read: false, ... }
    permission: { bash: "deny", read: "deny", ... }
  ç”¨é€”: æœ€å°æƒé™åœºæ™¯ã€åªè¯»ä»£ç†
  é£é™©: ä½
  é™åˆ¶: ä»£ç†åŠŸèƒ½å—é™

broad (å¹¿æ³›æƒé™):
  æè¿°: å¯ç”¨æ‰€æœ‰å·¥å…·,å…è®¸æ‰€æœ‰æ“ä½œ
  é…ç½®:
    tools: { bash: true, read: true, ... }
    permission: { bash: "allow", read: "allow", ... }
  ç”¨é€”: å¿«é€Ÿå¼€å‘ã€åŸå‹éªŒè¯ã€ä¿¡ä»»ç¯å¢ƒ
  é£é™©: é«˜
  é™åˆ¶: æ— 

from-commands (å‘½ä»¤æƒé™):
  æè¿°: æ ¹æ®å‘½ä»¤çš„ allowed-tools è‡ªåŠ¨æ˜ å°„
  é…ç½®:
    tools: { æŒ‰éœ€å¯ç”¨ }
    permission: { ç²¾ç¡®æ¨¡å¼åŒ¹é… }
  ç”¨é€”: ç”Ÿäº§ç¯å¢ƒã€å®‰å…¨ç¬¬ä¸€ã€æœ€å°æƒé™åŸåˆ™
  é£é™©: ä½
  é™åˆ¶: éœ€è¦å‘½ä»¤æ˜¾å¼å£°æ˜å·¥å…·
```

### 3.2 å·¥å…·æ˜ å°„è¡¨

```typescript
const TOOL_MAP: Record<string, string> = {
  // æ–‡ä»¶æ“ä½œ
  "read": "read",           // è¯»å–æ–‡ä»¶
  "write": "write",         // å†™å…¥æ–‡ä»¶
  "edit": "edit",           // ç¼–è¾‘æ–‡ä»¶
  "glob": "glob",           // æ–‡ä»¶æ¨¡å¼åŒ¹é…
  "grep": "grep",           // å†…å®¹æœç´¢
  "list": "list",           // åˆ—å‡ºç›®å½•

  // å‘½ä»¤æ‰§è¡Œ
  "bash": "bash",           // Shell å‘½ä»¤

  // ç½‘ç»œæ“ä½œ
  "webfetch": "webfetch",   // è·å–ç½‘é¡µå†…å®¹

  // ä»»åŠ¡ç®¡ç†
  "skill": "skill",         // è°ƒç”¨æŠ€èƒ½
  "task": "task",           // æ´¾é£ä»»åŠ¡
  "question": "question",   // æé—®ç”¨æˆ·

  // TODO ç®¡ç†
  "todowrite": "todowrite", // å†™å…¥ TODO
  "todoread": "todoread",   // è¯»å– TODO

  // å…¶ä»–
  "patch": "patch",         // åº”ç”¨è¡¥ä¸
}
```

### 3.3 æ¨¡å¼åŒ¹é…æƒé™

**from-commands æ¨¡å¼æ”¯æŒç²¾ç¡®çš„æ¨¡å¼åŒ¹é…**:

```typescript
// å‘½ä»¤å®šä¹‰ (commands/review.md)
---
allowed-tools:
  - read(docs/*)              # ä»…è¯»å– docs/ ç›®å½•
  - write(todos/*.md)         # ä»…å†™å…¥ todos/ ç›®å½•ä¸‹çš„ .md æ–‡ä»¶
  - bash(git:status)          # ä»…è¿è¡Œ git status
---
```

**è½¬æ¢ä¸º OpenCode æƒé™**:

```json
{
  "permission": {
    "read": {
      "*": "deny",
      "docs/*": "allow"
    },
    "write": {
      "*": "deny",
      "todos/*.md": "allow"
    },
    "bash": {
      "*": "deny",
      "git status": "allow"
    }
  },
  "tools": {
    "read": true,
    "write": true,
    "bash": true,
    "edit": false,
    "glob": false
  }
}
```

### 3.4 æƒé™ç»§æ‰¿è§„åˆ™

```yaml
è§„åˆ™ 1: write å’Œ edit äº’ç›¸å¯ç”¨
  å¦‚æœå¯ç”¨ write â†’ è‡ªåŠ¨å¯ç”¨ edit
  å¦‚æœå¯ç”¨ edit â†’ è‡ªåŠ¨å¯ç”¨ write
  åŸå› : ä¸¤è€…åŠŸèƒ½é‡å ,å®‰å…¨è¾¹ç•Œä¸€è‡´

è§„åˆ™ 2: æ¨¡å¼æƒé™ä¼˜å…ˆ
  å¦‚æœå®šä¹‰äº†æ¨¡å¼æƒé™ (å¦‚ "read(docs/*)")
  åˆ™å¿½ç•¥ç®€å•æƒé™,ä½¿ç”¨æ¨¡å¼åŒ¹é…

è§„åˆ™ 3: é»˜è®¤æ‹’ç»
  æœªæ˜¾å¼å…è®¸çš„æ“ä½œé»˜è®¤æ‹’ç»
  æ¨¡å¼åŒ¹é…ä¸­,"*" æ€»æ˜¯ "deny"
```

### 3.5 æƒé™éªŒè¯ç¤ºä¾‹

**åœºæ™¯**: Review å‘½ä»¤éœ€è¦è¯»å–ä»£ç ã€å†™å…¥å®¡æŸ¥æŠ¥å‘Š

**å‘½ä»¤å®šä¹‰**:

```markdown
---
name: review
allowed-tools:
  - read                      # è¯»å–æ‰€æœ‰æ–‡ä»¶
  - write(docs/reviews/*)     # ä»…å†™å…¥å®¡æŸ¥ç›®å½•
  - bash(git:diff, git:log)   # ä»…è¿è¡Œ git å‘½ä»¤
---
```

**è½¬æ¢åæƒé™** (broad æ¨¡å¼):

```json
{
  "permission": {
    "read": "allow",
    "write": "allow",
    "bash": "allow"
  },
  "tools": {
    "read": true,
    "write": true,
    "bash": true
  }
}
```

**è½¬æ¢åæƒé™** (from-commands æ¨¡å¼):

```json
{
  "permission": {
    "read": "allow",
    "write": {
      "*": "deny",
      "docs/reviews/*": "allow"
    },
    "edit": {
      "*": "deny",
      "docs/reviews/*": "allow"
    },
    "bash": {
      "*": "deny",
      "git diff": "allow",
      "git log": "allow"
    }
  },
  "tools": {
    "read": true,
    "write": true,
    "edit": true,
    "bash": true
  }
}
```

---

## 4. å¹³å°é›†æˆè¯¦è§£

### 4.1 Claude Code (å®˜æ–¹åŸç”Ÿæ”¯æŒ)

#### 4.1.1 æ’ä»¶ç»“æ„

```
plugins/compound-engineering/
â”œâ”€â”€ .claude-plugin/
â”‚   â”œâ”€â”€ plugin.json              # æ’ä»¶å…ƒæ•°æ®
â”‚   â””â”€â”€ marketplace.json         # å¸‚åœºé…ç½® (å¯é€‰)
â”‚
â”œâ”€â”€ agents/                      # 27 ä¸ªä»£ç†
â”‚   â”œâ”€â”€ kieran-rails-reviewer.md
â”‚   â”œâ”€â”€ python-code-reviewer.md
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ commands/                    # 20 ä¸ªå‘½ä»¤
â”‚   â”œâ”€â”€ brainstorm.md
â”‚   â”œâ”€â”€ plan.md
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ skills/                      # 14 ä¸ªæŠ€èƒ½
â”‚   â”œâ”€â”€ agent-native-architecture/
â”‚   â”‚   â””â”€â”€ SKILL.md
â”‚   â”œâ”€â”€ dhh-rails-style/
â”‚   â”‚   â””â”€â”€ SKILL.md
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ hooks/                       # Hooks ç³»ç»Ÿ (å¯é€‰)
â”‚   â””â”€â”€ hooks.json
â”‚
â”œâ”€â”€ README.md                    # æ’ä»¶æ–‡æ¡£
â””â”€â”€ CHANGELOG.md                 # ç‰ˆæœ¬å†å²
```

#### 4.1.2 plugin.json ç»“æ„

```json
{
  "name": "compound-engineering",
  "version": "2.28.0",
  "description": "Compound Engineering workflow for Claude Code. Includes 27 specialized agents, 20 commands, and 14 skill(s).",
  "author": {
    "name": "Kieran Klaassen",
    "url": "https://github.com/EveryInc"
  },
  "keywords": [
    "ai-powered",
    "compound-engineering",
    "workflow-automation",
    "knowledge-management"
  ],
  "agents": "agents",
  "commands": "commands",
  "skills": "skills",
  "hooks": "hooks/hooks.json",
  "mcpServers": {
    "context7": {
      "command": "npx",
      "args": ["-y", "@context7/mcp-server", "rails"]
    }
  }
}
```

#### 4.1.3 å®‰è£…æµç¨‹

```bash
# æ–¹æ³• 1: ä»å¸‚åœºå®‰è£… (æ¨è)
claude /plugin marketplace add https://github.com/EveryInc/compound-engineering-plugin
claude /plugin install compound-engineering

# æ–¹æ³• 2: ä»æœ¬åœ°å®‰è£…
claude /plugin install /path/to/compound-engineering-plugin

# æ–¹æ³• 3: å…‹éš†åå®‰è£…
git clone https://github.com/EveryInc/compound-engineering-plugin.git
cd compound-engineering-plugin
claude /plugin install .
```

**åº•å±‚æœºåˆ¶**:

```
/plugin install compound-engineering
    â†“
Claude Code è§£æ .claude-plugin/plugin.json
    â”œâ”€ è¯»å–å…ƒæ•°æ® (name, version, description)
    â”œâ”€ åŠ è½½ agents/ ç›®å½•
    â”œâ”€ åŠ è½½ commands/ ç›®å½•
    â”œâ”€ åŠ è½½ skills/ ç›®å½•
    â”œâ”€ åŠ è½½ hooks/hooks.json
    â””â”€ å¯åŠ¨ MCP servers
    â†“
æ³¨å†Œç»„ä»¶åˆ° Claude Code
    â”œâ”€ æ³¨å†Œä»£ç†: å¯é€šè¿‡ "agent <name>" è°ƒç”¨
    â”œâ”€ æ³¨å†Œå‘½ä»¤: å¯é€šè¿‡ "/<name>" è°ƒç”¨
    â”œâ”€ æ³¨å†ŒæŠ€èƒ½: å¯é€šè¿‡ "@<name>" å¼•ç”¨
    â””â”€ æ³¨å†Œ hooks: è‡ªåŠ¨è§¦å‘
    â†“
æ’ä»¶æ¿€æ´»
    â””â”€ ç»„ä»¶å¯ç«‹å³ä½¿ç”¨
```

#### 4.1.4 æ›´æ–°æµç¨‹

```bash
# æ£€æŸ¥æ›´æ–°
claude /plugin list

# æ›´æ–°æ’ä»¶
claude /plugin update compound-engineering

# åº•å±‚æ“ä½œ:
# 1. git fetch origin (åœ¨æ’ä»¶ç›®å½•)
# 2. git pull origin main
# 3. é‡æ–°åŠ è½½ plugin.json
# 4. çƒ­é‡è½½æ‰€æœ‰ç»„ä»¶
```

---

### 4.2 OpenCode (ç¤¾åŒºå¹³å°)

#### 4.2.1 è½¬æ¢å®‰è£…æµç¨‹

**ä½¿ç”¨ CLI å·¥å…·**:

```bash
# å®‰è£…å¹¶è½¬æ¢
compound-plugin install compound-engineering --to opencode

# æˆ–å…ˆè½¬æ¢åæ‰‹åŠ¨å®‰è£…
compound-plugin convert ./plugins/compound-engineering --to opencode --output ~/.config/opencode
```

**åº•å±‚æµç¨‹**:

```
compound-plugin install compound-engineering --to opencode
    â†“
è§£ææ’ä»¶è·¯å¾„
    â”œâ”€ æ£€æŸ¥æœ¬åœ°: ./plugins/compound-engineering
    â”œâ”€ æ£€æŸ¥æœ¬åœ°: ./compound-engineering
    â””â”€ ä» GitHub å…‹éš†: https://github.com/EveryInc/compound-engineering-plugin
    â†“
åŠ è½½ Claude æ’ä»¶
    â””â”€ loadClaudePlugin(path)
    â†“
è½¬æ¢ä¸º OpenCode æ ¼å¼
    â””â”€ convertClaudeToOpenCode(plugin, options)
        â”œâ”€ Agents â†’ agents/*.md
        â”œâ”€ Commands â†’ config.command
        â”œâ”€ Hooks â†’ plugins/converted-hooks.ts
        â””â”€ Permissions â†’ config.permission
    â†“
å†™å…¥æ–‡ä»¶
    â”œâ”€ ~/.config/opencode/opencode.json
    â”œâ”€ ~/.config/opencode/agents/*.md (27 ä¸ª)
    â”œâ”€ ~/.config/opencode/skills/* (14 ä¸ªç¬¦å·é“¾æ¥)
    â””â”€ ~/.config/opencode/plugins/converted-hooks.ts
    â†“
éªŒè¯å®‰è£…
    â””â”€ OpenCode å¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½
```

#### 4.2.2 opencode.json é…ç½®

```json
{
  "$schema": "https://opencode.ai/config.json",

  "command": {
    "workflows:brainstorm": {
      "description": "Interactive brainstorming using Socratic questioning",
      "template": "Use the @repo-research-analyst agent to...",
      "model": "anthropic/claude-opus-4"
    },
    "workflows:plan": {
      "description": "Create a detailed implementation plan",
      "template": "..."
    }
  },

  "mcp": {
    "context7": {
      "type": "local",
      "command": ["npx", "-y", "@context7/mcp-server", "rails"],
      "enabled": true
    }
  },

  "permission": {
    "read": "allow",
    "write": {
      "*": "deny",
      "docs/*": "allow",
      "todos/*": "allow"
    },
    "bash": {
      "*": "deny",
      "git status": "allow",
      "git diff": "allow",
      "git log": "allow"
    }
  },

  "tools": {
    "read": true,
    "write": true,
    "bash": true,
    "edit": true
  }
}
```

#### 4.2.3 Agent æ–‡ä»¶æ ¼å¼

**Claude Code æ ¼å¼** (è¾“å…¥):

```markdown
---
name: kieran-rails-reviewer
description: Rails code reviewer following Kieran's strict standards
capabilities:
  - Review Rails code for DHH conventions
  - Check for over-engineering
  - Verify test coverage
model: claude-opus-4
---

# Kieran Rails Reviewer

You are a Rails code reviewer...
```

**OpenCode æ ¼å¼** (è¾“å‡º):

```markdown
---
description: Rails code reviewer following Kieran's strict standards
mode: subagent
model: anthropic/claude-opus-4
temperature: 0.1
---

# Kieran Rails Reviewer

You are a Rails code reviewer...
```

**å·®å¼‚è¯´æ˜**:

```yaml
ç§»é™¤å­—æ®µ:
  - name (ä½¿ç”¨æ–‡ä»¶å)
  - capabilities (åˆå¹¶åˆ° body)

æ–°å¢å­—æ®µ:
  - mode: "subagent" (ä»£ç†è°ƒç”¨æ¨¡å¼)
  - temperature: 0.1 (æ¨æ–­æ¸©åº¦,å®¡æŸ¥ç±» = 0.1)

è½¬æ¢å­—æ®µ:
  - model: "claude-opus-4" â†’ "anthropic/claude-opus-4"
```

#### 4.2.4 Hooks æ’ä»¶è½¬æ¢

**Claude Code Hooks** (è¾“å…¥):

```json
{
  "hooks": {
    "SessionStart": [
      {
        "matcher": "startup|resume",
        "hooks": [
          {
            "type": "command",
            "command": "echo 'Welcome to Compound Engineering'"
          }
        ]
      }
    ],
    "PreToolUse": [
      {
        "matcher": "bash",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Verify this command is safe before running"
          }
        ]
      }
    ]
  }
}
```

**OpenCode Plugin** (è¾“å‡º):

```typescript
import type { Plugin } from "@opencode-ai/plugin"

export const ConvertedHooks: Plugin = async ({ $ }) => {
  return {
    "session.created": async (input) => {
      await $`echo 'Welcome to Compound Engineering'`
    },
    "tool.execute.before": async (input) => {
      if (input.tool === "bash") {
        // Claude PreToolUse
        // Prompt: Verify this command is safe before running
      }
    }
  }
}

export default ConvertedHooks
```

**äº‹ä»¶æ˜ å°„è¡¨**:

```typescript
const HOOK_EVENT_MAP = {
  // Claude Code â†’ OpenCode
  "SessionStart": { events: ["session.created"] },
  "SessionEnd": { events: ["session.deleted"] },
  "PreToolUse": { events: ["tool.execute.before"] },
  "PostToolUse": { events: ["tool.execute.after"] },
  "PermissionRequest": { events: ["permission.requested", "permission.replied"] },
}
```

---

### 4.3 Codex (æ›¿ä»£å¹³å°)

#### 4.3.1 è½¬æ¢å®‰è£…æµç¨‹

```bash
# å®‰è£…åˆ° Codex
compound-plugin install compound-engineering --to codex --codex-home ~/.codex

# æˆ–è½¬æ¢åæ‰‹åŠ¨å¤åˆ¶
compound-plugin convert ./plugins/compound-engineering --to codex --output ./codex-output
cp -r ./codex-output/* ~/.codex/
```

**åº•å±‚æµç¨‹**:

```
compound-plugin install compound-engineering --to codex
    â†“
åŠ è½½ Claude æ’ä»¶
    â””â”€ loadClaudePlugin(path)
    â†“
è½¬æ¢ä¸º Codex æ ¼å¼
    â””â”€ convertClaudeToCodex(plugin, options)
        â”œâ”€ Agents â†’ Skills (skills/*.md)
        â”œâ”€ Commands â†’ Prompts (prompts/*.md) + Skills
        â”œâ”€ è¯­æ³•è½¬æ¢ (Task â†’ skill è°ƒç”¨)
        â””â”€ åç§°è§„èŒƒåŒ–
    â†“
å†™å…¥æ–‡ä»¶
    â”œâ”€ ~/.codex/prompts/*.md (20 ä¸ª)
    â”œâ”€ ~/.codex/skills/*.md (27 ä¸ªç”Ÿæˆ)
    â”œâ”€ ~/.codex/skills/* (14 ä¸ªç¬¦å·é“¾æ¥)
    â””â”€ ~/.codex/agents.md (ä»£ç†åˆ—è¡¨)
    â†“
ç”Ÿæˆ agents.md
    â””â”€ ensureCodexAgentsFile(~/.codex)
    â†“
éªŒè¯å®‰è£…
    â””â”€ Codex å¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½
```

#### 4.3.2 Agent â†’ Skill è½¬æ¢

**Claude Code Agent** (è¾“å…¥):

```markdown
---
name: kieran-rails-reviewer
description: Rails code reviewer following Kieran's strict standards
capabilities:
  - Review Rails code for DHH conventions
  - Check for over-engineering
---

You are a Rails code reviewer...
```

**Codex Skill** (è¾“å‡º):

```markdown
---
name: kieran-rails-reviewer
description: Rails code reviewer following Kieran's strict standards
---

## Capabilities
- Review Rails code for DHH conventions
- Check for over-engineering

You are a Rails code reviewer...
```

#### 4.3.3 Command â†’ Prompt + Skill è½¬æ¢

**Claude Code Command** (è¾“å…¥):

```markdown
---
name: workflows:review
description: Comprehensive code review workflow
argument-hint: [files or git ref]
allowed-tools:
  - read
  - write(docs/reviews/*)
---

## Review Workflow

Phase 1: Analysis
   - Task code-quality-reviewer(analyze changes)
   - Run /utils:run-tests to verify tests pass

Phase 2: Report
   - Generate review report in docs/reviews/
```

**Codex Prompt** (è¾“å‡º):

```markdown
---
description: Comprehensive code review workflow
argument-hint: [files or git ref]
---

Use the $workflows-review skill for this command and follow its instructions.

## Review Workflow

Phase 1: Analysis
   - Use the $code-quality-reviewer skill to: analyze changes
   - Run /prompts:utils-run-tests to verify tests pass

Phase 2: Report
   - Generate review report in docs/reviews/
```

**Codex Skill** (è¾“å‡º):

```markdown
---
name: workflows-review
description: Comprehensive code review workflow
---

## Arguments
[files or git ref]

## Allowed tools
- read
- write(docs/reviews/*)

## Review Workflow

Phase 1: Analysis
   - Use the $code-quality-reviewer skill to: analyze changes
   - Run /prompts:utils-run-tests to verify tests pass

Phase 2: Report
   - Generate review report in docs/reviews/
```

#### 4.3.4 è¯­æ³•è½¬æ¢ç¤ºä¾‹

**Claude Code è¯­æ³•**:

```markdown
1. Task repo-research-analyst(analyze current patterns)
2. Run /workflows:brainstorm to explore options
3. Consult @security-reviewer for security aspects
```

**Codex è¯­æ³•** (è½¬æ¢å):

```markdown
1. Use the $repo-research-analyst skill to: analyze current patterns
2. Run /prompts:workflows-brainstorm to explore options
3. Consult $security-reviewer skill for security aspects
```

**è½¬æ¢è§„åˆ™**:

```yaml
è§„åˆ™ 1: Task è°ƒç”¨ â†’ skill å¼•ç”¨
  Claude: Task <agent>(<args>)
  Codex:  Use the $<agent> skill to: <args>

è§„åˆ™ 2: æ–œæ å‘½ä»¤ â†’ æç¤ºè¯å¼•ç”¨
  Claude: /workflows:brainstorm
  Codex:  /prompts:workflows-brainstorm

è§„åˆ™ 3: @ ä»£ç†å¼•ç”¨ â†’ skill å¼•ç”¨
  Claude: @security-reviewer
  Codex:  $security-reviewer skill
```

---

## 5. ç»„ä»¶ä¼˜å…ˆçº§ä¸é®è”½æœºåˆ¶

### 5.1 ç»„ä»¶æœç´¢è·¯å¾„

Compound Engineering Plugin æ”¯æŒä¸‰çº§ç»„ä»¶ç›®å½•ç³»ç»Ÿ,å®ç°ä¸ªäººå®šåˆ¶å’Œé¡¹ç›®å®šåˆ¶:

```
ç»„ä»¶åŠ è½½ä¼˜å…ˆçº§ (ä»é«˜åˆ°ä½):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ä¼˜å…ˆçº§ 1: ä¸ªäººç»„ä»¶ (æœ€é«˜)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Claude Code: ~/.claude/agents/, ~/.claude/commands/, ~/.claude/skills/
  OpenCode:    ~/.config/opencode/agents/, ~/.config/opencode/skills/
  Codex:       ~/.codex/prompts/, ~/.codex/skills/

ä¼˜å…ˆçº§ 2: é¡¹ç›®ç»„ä»¶
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Claude Code: ./.claude/agents/, ./.claude/commands/, ./.claude/skills/
  OpenCode:    ./.opencode/agents/, ./.opencode/skills/
  Codex:       ./.codex/prompts/, ./.codex/skills/

ä¼˜å…ˆçº§ 3: æ’ä»¶å®˜æ–¹ç»„ä»¶ (é»˜è®¤)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  æ‰€æœ‰å¹³å°:    <plugin-root>/agents/, <plugin-root>/commands/, <plugin-root>/skills/
```

### 5.2 é®è”½è§„åˆ™

**åŒåç»„ä»¶é®è”½**:

```yaml
è§„åˆ™: é«˜ä¼˜å…ˆçº§ç›®å½•ä¸­çš„åŒåç»„ä»¶é®è”½ä½ä¼˜å…ˆçº§ç»„ä»¶

ç¤ºä¾‹:
  å®˜æ–¹ç»„ä»¶: <plugin-root>/agents/kieran-rails-reviewer.md
  ä¸ªäººç»„ä»¶: ~/.claude/agents/kieran-rails-reviewer.md

  åŠ è½½ç»“æœ: ~/.claude/agents/kieran-rails-reviewer.md (ä¸ªäººç»„ä»¶)
  åŸå› : ä¸ªäººç»„ä»¶ä¼˜å…ˆçº§ > æ’ä»¶ç»„ä»¶
```

### 5.3 å®šåˆ¶åœºæ™¯ç¤ºä¾‹

#### åœºæ™¯ 1: ä¸ªäººå®šåˆ¶ä»£ç†

**éœ€æ±‚**: ä¿®æ”¹ Rails Reviewer çš„å®¡æŸ¥æ ‡å‡†

**æ­¥éª¤**:

```bash
# 1. å¤åˆ¶å®˜æ–¹ä»£ç†
cp <plugin-root>/agents/kieran-rails-reviewer.md ~/.claude/agents/

# 2. ä¿®æ”¹ä¸ªäººç‰ˆæœ¬
vim ~/.claude/agents/kieran-rails-reviewer.md
# ä¿®æ”¹å®¡æŸ¥åŸåˆ™ã€æ£€æŸ¥é¡¹ç­‰

# 3. ä½¿ç”¨æ—¶è‡ªåŠ¨åŠ è½½ä¸ªäººç‰ˆæœ¬
claude agent kieran-rails-reviewer "review this code"
# åŠ è½½: ~/.claude/agents/kieran-rails-reviewer.md
# å¿½ç•¥: <plugin-root>/agents/kieran-rails-reviewer.md
```

**é®è”½æ•ˆæœ**:

```
è°ƒç”¨: claude agent kieran-rails-reviewer
    â†“
æœç´¢ç»„ä»¶
    â”œâ”€ æ£€æŸ¥: ~/.claude/agents/kieran-rails-reviewer.md âœ… æ‰¾åˆ°
    â”œâ”€ è·³è¿‡: <plugin-root>/agents/kieran-rails-reviewer.md (è¢«é®è”½)
    â””â”€ åŠ è½½: ~/.claude/agents/kieran-rails-reviewer.md
```

#### åœºæ™¯ 2: é¡¹ç›®å®šåˆ¶å‘½ä»¤

**éœ€æ±‚**: é¡¹ç›®ç‰¹å®šçš„ brainstorm æµç¨‹

**æ­¥éª¤**:

```bash
# 1. åˆ›å»ºé¡¹ç›®å‘½ä»¤
mkdir -p .claude/commands
cat > .claude/commands/brainstorm.md <<'EOF'
---
name: brainstorm
description: Project-specific brainstorm workflow
---

# Project Brainstorm

1. Check project-specific constraints in CONSTRAINTS.md
2. Review current architecture in docs/architecture/
3. Run standard brainstorm process
EOF

# 2. ä½¿ç”¨é¡¹ç›®å‘½ä»¤
claude /brainstorm
# åŠ è½½: ./.claude/commands/brainstorm.md
# å¿½ç•¥: <plugin-root>/commands/brainstorm.md
```

#### åœºæ™¯ 3: å¼ºåˆ¶ä½¿ç”¨å®˜æ–¹ç»„ä»¶

**éœ€æ±‚**: å³ä½¿æœ‰ä¸ªäººå®šåˆ¶,ä¹Ÿè¦ä½¿ç”¨å®˜æ–¹ç‰ˆæœ¬

**æ–¹æ³•**: ä½¿ç”¨å‘½åç©ºé—´å‰ç¼€

```bash
# OpenCode: ä½¿ç”¨æ’ä»¶å‰ç¼€
claude agent compound-engineering:kieran-rails-reviewer

# Codex: æŒ‡å®šå®Œæ•´è·¯å¾„
Use the $compound-engineering/kieran-rails-reviewer skill
```

**æ³¨æ„**: æ­¤åŠŸèƒ½ä¾èµ–å¹³å°æ”¯æŒ,Compound Engineering Plugin è½¬æ¢å™¨æš‚æœªå®ç°ã€‚

### 5.4 ç»„ä»¶ä¼˜å…ˆçº§é…ç½®

**åœ¨ plugin.json ä¸­è‡ªå®šä¹‰ç»„ä»¶ç›®å½•**:

```json
{
  "name": "compound-engineering",
  "agents": ["agents", "custom-agents"],
  "commands": ["commands"],
  "skills": ["skills", "../shared-skills"]
}
```

**åŠ è½½é¡ºåº**:

```
åŠ è½½ agents:
  1. ~/.claude/agents/ (ä¸ªäºº)
  2. ./.claude/agents/ (é¡¹ç›®)
  3. <plugin-root>/agents/ (å®˜æ–¹é»˜è®¤)
  4. <plugin-root>/custom-agents/ (å®˜æ–¹è‡ªå®šä¹‰)
```

---

## 6. æ€§èƒ½ä¸ä¼˜åŒ–ç­–ç•¥

### 6.1 ç»„ä»¶åŠ è½½ä¼˜åŒ–

#### 6.1.1 å»¶è¿ŸåŠ è½½ (Lazy Loading)

```typescript
// æ’ä»¶å¯åŠ¨æ—¶: ä»…åŠ è½½å…ƒæ•°æ®
const plugin = await loadClaudePlugin(path)
// ä»…è¯»å– plugin.json å’Œç»„ä»¶ frontmatter
// ä¸è¯»å–å®Œæ•´ body

// ç»„ä»¶è°ƒç”¨æ—¶: åŠ è½½å®Œæ•´å†…å®¹
const agent = await loadAgentContent(agentName)
// è¯»å–å®Œæ•´ markdown å†…å®¹
```

**ä¼˜åŒ–æ•ˆæœ**:

```
æ— å»¶è¿ŸåŠ è½½:
  å¯åŠ¨æ—¶é—´: 500ms (åŠ è½½ 61 ä¸ªç»„ä»¶å®Œæ•´å†…å®¹)
  å†…å­˜å ç”¨: 10MB

å»¶è¿ŸåŠ è½½:
  å¯åŠ¨æ—¶é—´: 50ms (ä»…åŠ è½½å…ƒæ•°æ®)
  å†…å­˜å ç”¨: 1MB
  é¦–æ¬¡è°ƒç”¨å»¶è¿Ÿ: 10ms (åŠ è½½å•ä¸ªç»„ä»¶)
```

#### 6.1.2 ç´¢å¼•ç¼“å­˜

```typescript
// é¦–æ¬¡å¯åŠ¨: æ„å»ºç»„ä»¶ç´¢å¼•
const index: ComponentIndex = {
  agents: new Map([
    ["kieran-rails-reviewer", "/path/to/agent.md"],
    // ...
  ]),
  commands: new Map([...]),
  skills: new Map([...])
}

// ä¿å­˜ç´¢å¼•åˆ°ç¼“å­˜
await writeJson("~/.cache/compound-plugin/index.json", index)

// åç»­å¯åŠ¨: è¯»å–ç´¢å¼•
const cachedIndex = await readJson("~/.cache/compound-plugin/index.json")

// æŸ¥æ‰¾ç»„ä»¶: O(1) å“ˆå¸ŒæŸ¥æ‰¾
const agentPath = cachedIndex.agents.get("kieran-rails-reviewer")
```

**ä¼˜åŒ–æ•ˆæœ**:

```
æ— ç´¢å¼•:
  æŸ¥æ‰¾ç»„ä»¶: é€’å½’æ‰«æ 3 ä¸ªç›®å½•,O(N) å¤æ‚åº¦
  å¹³å‡æ—¶é—´: 20ms

ç´¢å¼•ç¼“å­˜:
  æŸ¥æ‰¾ç»„ä»¶: å“ˆå¸ŒæŸ¥æ‰¾,O(1) å¤æ‚åº¦
  å¹³å‡æ—¶é—´: 1ms
```

#### 6.1.3 å¢é‡æ›´æ–°æ£€æµ‹

```typescript
// æ’ä»¶æ›´æ–°æ£€æµ‹
async function checkPluginUpdates(pluginRoot: string): Promise<boolean> {
  const gitDir = path.join(pluginRoot, ".git")
  if (!await pathExists(gitDir)) return false

  try {
    // è½»é‡çº§æ£€æµ‹ (ä¸æ‹‰å–å®Œæ•´å†…å®¹)
    const result = execSync(
      "git fetch --dry-run origin 2>&1",
      { cwd: pluginRoot, timeout: 3000 }
    )

    return result.includes("->")  // æœ‰æ›´æ–°
  } catch {
    return false  // è¶…æ—¶æˆ–ç½‘ç»œé”™è¯¯
  }
}
```

**ä¼˜åŒ–ç­–ç•¥**:

```yaml
é¢‘ç‡æ§åˆ¶:
  - æ¯ä¼šè¯æ£€æŸ¥ä¸€æ¬¡ (SessionStart hook)
  - ä¸åœ¨æ¯æ¬¡å‘½ä»¤è°ƒç”¨æ—¶æ£€æŸ¥
  - ç”¨æˆ·å¯æ‰‹åŠ¨è§¦å‘æ£€æŸ¥

è¶…æ—¶æ§åˆ¶:
  - git fetch è¶…æ—¶: 3 ç§’
  - é˜²æ­¢é˜»å¡: ç½‘ç»œæ…¢ä¸å½±å“å¯åŠ¨

å¼‚æ­¥æ£€æŸ¥ (å¯é€‰):
  - åå°çº¿ç¨‹æ£€æŸ¥æ›´æ–°
  - ä¸»çº¿ç¨‹ç»§ç»­å¯åŠ¨
  - æœ‰æ›´æ–°æ—¶å¼‚æ­¥é€šçŸ¥
```

### 6.2 è½¬æ¢ä¼˜åŒ–

#### 6.2.1 å¹¶è¡Œè½¬æ¢

```typescript
// ä¸²è¡Œè½¬æ¢ (æ…¢)
const agents = []
for (const agent of plugin.agents) {
  agents.push(await convertAgent(agent))
}

// å¹¶è¡Œè½¬æ¢ (å¿«)
const agents = await Promise.all(
  plugin.agents.map(agent => convertAgent(agent))
)
```

**æ€§èƒ½å¯¹æ¯”**:

```
ä¸²è¡Œè½¬æ¢ (27 ä¸ªä»£ç†):
  æ€»æ—¶é—´: 270ms (æ¯ä¸ª 10ms)

å¹¶è¡Œè½¬æ¢ (27 ä¸ªä»£ç†):
  æ€»æ—¶é—´: 20ms (å¹¶è¡Œå¤„ç†)
  åŠ é€Ÿ: 13.5x
```

#### 6.2.2 æ¨¡æ¿ç¼“å­˜

```typescript
// Hooks è½¬æ¢æ¨¡æ¿ç¼“å­˜
const hookTemplateCache = new Map<string, string>()

function renderHookHandlers(event: string, ...): string {
  const cacheKey = `${event}-${JSON.stringify(matchers)}`

  if (hookTemplateCache.has(cacheKey)) {
    return hookTemplateCache.get(cacheKey)!
  }

  const rendered = // ... æ¸²æŸ“é€»è¾‘
  hookTemplateCache.set(cacheKey, rendered)
  return rendered
}
```

#### 6.2.3 å†…å®¹è½¬æ¢ä¼˜åŒ–

```typescript
// ä¼˜åŒ–æ­£åˆ™è¡¨è¾¾å¼ (é¢„ç¼–è¯‘)
const TASK_PATTERN = /^(\s*-?\s*)Task\s+([a-z][a-z0-9-]*)\(([^)]+)\)/gm
const SLASH_COMMAND_PATTERN = /(?<![:\w])\/([a-z][a-z0-9_:-]*?)(?=[\s,."')\]}`]|$)/gi

// ä¸€æ¬¡éå†å®Œæˆæ‰€æœ‰è½¬æ¢
function transformContentForCodex(body: string): string {
  return body
    .replace(TASK_PATTERN, taskReplacer)
    .replace(SLASH_COMMAND_PATTERN, commandReplacer)
    .replace(AGENT_REF_PATTERN, agentReplacer)
}
```

### 6.3 æ–‡ä»¶ç³»ç»Ÿä¼˜åŒ–

#### 6.3.1 ç¬¦å·é“¾æ¥ vs å¤åˆ¶

```yaml
ç¬¦å·é“¾æ¥ (æ¨è):
  ä¼˜ç‚¹:
    - ä¸å ç”¨é¢å¤–ç©ºé—´
    - å®æ—¶åŒæ­¥æ›´æ–°
    - åˆ›å»ºé€Ÿåº¦å¿« (< 1ms)
  ç¼ºç‚¹:
    - Windows éœ€è¦ç®¡ç†å‘˜æƒé™
    - è·¨åˆ†åŒºå¯èƒ½ä¸æ”¯æŒ

æ–‡ä»¶å¤åˆ¶:
  ä¼˜ç‚¹:
    - æ— æƒé™è¦æ±‚
    - è·¨å¹³å°å…¼å®¹
  ç¼ºç‚¹:
    - å ç”¨åŒå€ç©ºé—´ (14 ä¸ªæŠ€èƒ½ â‰ˆ 2MB)
    - æ›´æ–°éœ€è¦é‡æ–°å¤åˆ¶
    - å¤åˆ¶é€Ÿåº¦æ…¢ (100ms+)

ç­–ç•¥:
  - ä¼˜å…ˆä½¿ç”¨ç¬¦å·é“¾æ¥
  - Windows éç®¡ç†å‘˜ â†’ é™çº§ä¸ºå¤åˆ¶
  - æç¤ºç”¨æˆ·å¯ç”¨å¼€å‘è€…æ¨¡å¼ (æ”¯æŒæ— æƒé™ç¬¦å·é“¾æ¥)
```

#### 6.3.2 æ‰¹é‡å†™å…¥

```typescript
// å•ä¸ªå†™å…¥ (æ…¢)
for (const agent of bundle.agents) {
  await writeText(`agents/${agent.name}.md`, agent.content)
}

// æ‰¹é‡å†™å…¥ (å¿«)
await Promise.all(
  bundle.agents.map(agent =>
    writeText(`agents/${agent.name}.md`, agent.content)
  )
)
```

**æ€§èƒ½å¯¹æ¯”**:

```
å•ä¸ªå†™å…¥ (27 ä¸ªä»£ç†):
  æ€»æ—¶é—´: 270ms (æ¯ä¸ª 10ms)

æ‰¹é‡å†™å…¥ (27 ä¸ªä»£ç†):
  æ€»æ—¶é—´: 30ms (å¹¶è¡Œ I/O)
  åŠ é€Ÿ: 9x
```

### 6.4 å†…å­˜ä¼˜åŒ–

#### 6.4.1 æµå¼å¤„ç†

```typescript
// å†…å­˜å¯†é›† (ä¸æ¨è)
const content = await readText(filePath)
const transformed = transformContent(content)
await writeText(outputPath, transformed)

// æµå¼å¤„ç† (æ¨è,å¯¹å¤§æ–‡ä»¶)
const readStream = fs.createReadStream(filePath)
const writeStream = fs.createWriteStream(outputPath)
readStream
  .pipe(transformStream())
  .pipe(writeStream)
```

**é€‚ç”¨åœºæ™¯**:

```yaml
å°æ–‡ä»¶ (< 100KB):
  - ç›´æ¥è¯»å–åˆ°å†…å­˜
  - è½¬æ¢åå†™å…¥
  - ç®€å•å¿«é€Ÿ

å¤§æ–‡ä»¶ (> 1MB):
  - æµå¼å¤„ç†
  - åˆ†å—è½¬æ¢
  - å†…å­˜å‹å¥½
```

#### 6.4.2 åƒåœ¾å›æ”¶ä¼˜åŒ–

```typescript
// åŠæ—¶é‡Šæ”¾å¤§å¯¹è±¡
async function convertPlugin(plugin: ClaudePlugin): Promise<void> {
  const bundle = convertClaudeToOpenCode(plugin, options)
  await writeBundle(bundle)

  // æ˜¾å¼é‡Šæ”¾ (å¯é€‰)
  bundle = null
  plugin = null

  // å»ºè®® GC (å¯é€‰)
  if (global.gc) global.gc()
}
```

---

## 7. è°ƒè¯•ä¸æ—¥å¿—

### 7.1 è°ƒè¯•æ¨¡å¼

#### 7.1.1 å¯ç”¨è°ƒè¯•

```bash
# ç¯å¢ƒå˜é‡
export COMPOUND_PLUGIN_DEBUG=1
compound-plugin convert ./plugins/compound-engineering --to opencode

# æˆ–ä¸€æ¬¡æ€§å¯ç”¨
COMPOUND_PLUGIN_DEBUG=1 compound-plugin install compound-engineering --to codex
```

#### 7.1.2 è°ƒè¯•è¾“å‡º

```typescript
// åœ¨ä»£ç ä¸­æ£€æµ‹è°ƒè¯•æ¨¡å¼
const DEBUG = process.env.COMPOUND_PLUGIN_DEBUG === "1"

function debugLog(...args: unknown[]): void {
  if (DEBUG) {
    console.log("[DEBUG]", ...args)
  }
}

// ä½¿ç”¨ç¤ºä¾‹
debugLog("Loading plugin from:", pluginRoot)
debugLog("Found agents:", agents.length)
debugLog("Converting to:", targetName)
```

**è°ƒè¯•è¾“å‡ºç¤ºä¾‹**:

```
[DEBUG] Loading plugin from: /Users/user/plugins/compound-engineering
[DEBUG] Manifest: { name: 'compound-engineering', version: '2.28.0' }
[DEBUG] Found agents: 27
[DEBUG] Found commands: 20
[DEBUG] Found skills: 14
[DEBUG] Converting to: opencode
[DEBUG] Converting agent: kieran-rails-reviewer
[DEBUG] Inferred temperature: 0.1 (review agent)
[DEBUG] Writing agent: kieran-rails-reviewer.md
[DEBUG] Creating symlink: skills/agent-native-architecture â†’ /path/to/source
[DEBUG] Conversion complete: ~/.config/opencode
```

### 7.2 æ—¥å¿—ç³»ç»Ÿ

#### 7.2.1 æ—¥å¿—çº§åˆ«

```typescript
enum LogLevel {
  DEBUG = 0,
  INFO = 1,
  WARN = 2,
  ERROR = 3
}

class Logger {
  constructor(private level: LogLevel) {}

  debug(...args: unknown[]): void {
    if (this.level <= LogLevel.DEBUG) {
      console.log("[DEBUG]", ...args)
    }
  }

  info(...args: unknown[]): void {
    if (this.level <= LogLevel.INFO) {
      console.log("[INFO]", ...args)
    }
  }

  warn(...args: unknown[]): void {
    if (this.level <= LogLevel.WARN) {
      console.warn("[WARN]", ...args)
    }
  }

  error(...args: unknown[]): void {
    if (this.level <= LogLevel.ERROR) {
      console.error("[ERROR]", ...args)
    }
  }
}

// ä½¿ç”¨
const logger = new Logger(
  process.env.COMPOUND_PLUGIN_DEBUG ? LogLevel.DEBUG : LogLevel.INFO
)
```

#### 7.2.2 æ—¥å¿—æ–‡ä»¶

```typescript
// å†™å…¥æ—¥å¿—æ–‡ä»¶ (å¯é€‰)
import { appendFileSync } from "fs"
import path from "path"
import os from "os"

const LOG_FILE = path.join(os.homedir(), ".compound-plugin", "debug.log")

function log(level: string, ...args: unknown[]): void {
  const timestamp = new Date().toISOString()
  const message = `[${timestamp}] [${level}] ${args.join(" ")}\n`

  // æ§åˆ¶å°è¾“å‡º
  console.log(message.trim())

  // æ–‡ä»¶è¾“å‡º
  appendFileSync(LOG_FILE, message, "utf-8")
}
```

**æ—¥å¿—æ–‡ä»¶ç¤ºä¾‹**:

```
[2026-01-31T10:15:30.123Z] [INFO] Starting conversion
[2026-01-31T10:15:30.234Z] [DEBUG] Loading plugin from: /path/to/plugin
[2026-01-31T10:15:30.345Z] [INFO] Converted 27 agents
[2026-01-31T10:15:30.456Z] [WARN] Unmapped hook events: SubagentStart, SubagentStop
[2026-01-31T10:15:30.567Z] [INFO] Conversion complete
```

### 7.3 é”™è¯¯è¿½è¸ª

#### 7.3.1 é”™è¯¯ç±»å‹

```typescript
// è‡ªå®šä¹‰é”™è¯¯ç±»
class PluginError extends Error {
  constructor(
    message: string,
    public code: string,
    public context?: Record<string, unknown>
  ) {
    super(message)
    this.name = "PluginError"
  }
}

// ä½¿ç”¨ç¤ºä¾‹
throw new PluginError(
  "Failed to load plugin manifest",
  "MANIFEST_NOT_FOUND",
  { path: manifestPath }
)
```

#### 7.3.2 é”™è¯¯å¤„ç†

```typescript
try {
  const plugin = await loadClaudePlugin(pluginPath)
  const bundle = convertClaudeToOpenCode(plugin, options)
  await writeBundle(outputRoot, bundle)
} catch (error) {
  if (error instanceof PluginError) {
    console.error(`[${error.code}] ${error.message}`)
    if (error.context) {
      console.error("Context:", JSON.stringify(error.context, null, 2))
    }
  } else {
    console.error("Unexpected error:", error)
  }
  process.exit(1)
}
```

### 7.4 æ€§èƒ½åˆ†æ

#### 7.4.1 æ—¶é—´æµ‹é‡

```typescript
class Timer {
  private start: number

  constructor(private label: string) {
    this.start = Date.now()
  }

  end(): void {
    const duration = Date.now() - this.start
    console.log(`[PERF] ${this.label}: ${duration}ms`)
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const timer = new Timer("Plugin conversion")
await convertPlugin(plugin)
timer.end()

// è¾“å‡º: [PERF] Plugin conversion: 234ms
```

#### 7.4.2 å†…å­˜åˆ†æ

```typescript
function logMemoryUsage(): void {
  const used = process.memoryUsage()
  console.log("[MEMORY]", {
    rss: `${Math.round(used.rss / 1024 / 1024)}MB`,
    heapUsed: `${Math.round(used.heapUsed / 1024 / 1024)}MB`,
    heapTotal: `${Math.round(used.heapTotal / 1024 / 1024)}MB`
  })
}

// ä½¿ç”¨ç¤ºä¾‹
logMemoryUsage()  // è½¬æ¢å‰
await convertPlugin(plugin)
logMemoryUsage()  // è½¬æ¢å
```

---

## 8. å¸¸è§é—®é¢˜æ’æŸ¥

### 8.1 è½¬æ¢å¤±è´¥

#### é—®é¢˜ 1: æ‰¾ä¸åˆ° plugin.json

**é”™è¯¯ä¿¡æ¯**:

```
Error: Could not find .claude-plugin/plugin.json under /path/to/plugin
```

**æ’æŸ¥æ­¥éª¤**:

```bash
# 1. éªŒè¯è·¯å¾„
ls -la /path/to/plugin/.claude-plugin/plugin.json

# 2. æ£€æŸ¥ç›®å½•ç»“æ„
tree /path/to/plugin -L 2

# 3. éªŒè¯ plugin.json æ ¼å¼
cat /path/to/plugin/.claude-plugin/plugin.json | jq .
```

**è§£å†³æ–¹æ¡ˆ**:

```bash
# ç¡®ä¿è·¯å¾„æ­£ç¡®
compound-plugin convert /correct/path/to/plugin --to opencode

# æˆ–ä½¿ç”¨ç›¸å¯¹è·¯å¾„
cd /correct/path
compound-plugin convert ./plugin --to opencode
```

---

#### é—®é¢˜ 2: YAML Frontmatter è§£æå¤±è´¥

**é”™è¯¯ä¿¡æ¯**:

```
Error: Invalid frontmatter in agents/my-agent.md
```

**æ’æŸ¥æ­¥éª¤**:

```bash
# 1. æ£€æŸ¥ frontmatter æ ¼å¼
head -10 agents/my-agent.md

# 2. éªŒè¯ YAML è¯­æ³•
cat agents/my-agent.md | sed -n '/^---$/,/^---$/p' | yq .
```

**å¸¸è§é”™è¯¯**:

```yaml
# âŒ é”™è¯¯: ç¼ºå°‘ç»“æŸæ ‡è®°
---
name: my-agent
description: My agent

# âœ… æ­£ç¡®
---
name: my-agent
description: My agent
---

# âŒ é”™è¯¯: ç¼©è¿›ä¸ä¸€è‡´
---
name: my-agent
  description: My agent
---

# âœ… æ­£ç¡®
---
name: my-agent
description: My agent
---
```

---

#### é—®é¢˜ 3: æƒé™æ˜ å°„å¤±è´¥

**é”™è¯¯ä¿¡æ¯**:

```
Warning: Unknown tool in allowed-tools: unknowntool
```

**æ’æŸ¥æ­¥éª¤**:

```bash
# 1. æ£€æŸ¥ allowed-tools å®šä¹‰
grep -r "allowed-tools" commands/

# 2. æŸ¥çœ‹æ”¯æŒçš„å·¥å…·åˆ—è¡¨
compound-plugin convert --help | grep -A 20 "Supported tools"
```

**æ”¯æŒçš„å·¥å…·**:

```yaml
æ–‡ä»¶æ“ä½œ:
  - read
  - write
  - edit
  - glob
  - grep
  - list

å‘½ä»¤æ‰§è¡Œ:
  - bash

ç½‘ç»œ:
  - webfetch

ä»»åŠ¡:
  - skill
  - task
  - question
  - todowrite
  - todoread
  - patch
```

**è§£å†³æ–¹æ¡ˆ**:

```markdown
<!-- ä¿®æ­£ allowed-tools -->
---
allowed-tools:
  - read
  - write(docs/*)
  - bash(git:status, git:diff)
---
```

---

### 8.2 å®‰è£…å¤±è´¥

#### é—®é¢˜ 1: GitHub å…‹éš†å¤±è´¥

**é”™è¯¯ä¿¡æ¯**:

```
Error: Failed to clone https://github.com/EveryInc/compound-engineering-plugin. fatal: unable to access 'https://github.com/...': Could not resolve host: github.com
```

**æ’æŸ¥æ­¥éª¤**:

```bash
# 1. æ£€æŸ¥ç½‘ç»œè¿æ¥
ping github.com

# 2. æ£€æŸ¥ Git é…ç½®
git config --global --list | grep http

# 3. æµ‹è¯•å…‹éš†
git clone --depth 1 https://github.com/EveryInc/compound-engineering-plugin /tmp/test
```

**è§£å†³æ–¹æ¡ˆ**:

```bash
# æ–¹æ¡ˆ 1: æ‰‹åŠ¨å…‹éš†åå®‰è£…
git clone https://github.com/EveryInc/compound-engineering-plugin.git
compound-plugin install ./compound-engineering-plugin --to opencode

# æ–¹æ¡ˆ 2: ä½¿ç”¨ä»£ç†
export https_proxy=http://proxy.example.com:8080
compound-plugin install compound-engineering --to opencode

# æ–¹æ¡ˆ 3: ä»æœ¬åœ°å‰¯æœ¬å®‰è£…
compound-plugin install /path/to/local/copy --to opencode
```

---

#### é—®é¢˜ 2: ç¬¦å·é“¾æ¥åˆ›å»ºå¤±è´¥ (Windows)

**é”™è¯¯ä¿¡æ¯**:

```
Error: EPERM: operation not permitted, symlink 'C:\...' -> 'C:\...'
```

**æ’æŸ¥æ­¥éª¤**:

```powershell
# 1. æ£€æŸ¥æ˜¯å¦æœ‰ç®¡ç†å‘˜æƒé™
whoami /groups | findstr "S-1-16-12288"

# 2. æ£€æŸ¥å¼€å‘è€…æ¨¡å¼
Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\AppModelUnlock" -Name "AllowDevelopmentWithoutDevLicense"
```

**è§£å†³æ–¹æ¡ˆ**:

```powershell
# æ–¹æ¡ˆ 1: ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ
# å³é”® -> ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ PowerShell
compound-plugin install compound-engineering --to opencode

# æ–¹æ¡ˆ 2: å¯ç”¨å¼€å‘è€…æ¨¡å¼
# è®¾ç½® -> æ›´æ–°å’Œå®‰å…¨ -> å¼€å‘è€…é€‰é¡¹ -> å¼€å‘äººå‘˜æ¨¡å¼ (å¯ç”¨)

# æ–¹æ¡ˆ 3: ä½¿ç”¨å¤åˆ¶æ›¿ä»£ç¬¦å·é“¾æ¥
# (ä¿®æ”¹ä»£ç ,é™çº§ä¸ºæ–‡ä»¶å¤åˆ¶)
```

---

#### é—®é¢˜ 3: ç›®æ ‡ç›®å½•æƒé™ä¸è¶³

**é”™è¯¯ä¿¡æ¯**:

```
Error: EACCES: permission denied, mkdir '/root/.config/opencode'
```

**æ’æŸ¥æ­¥éª¤**:

```bash
# 1. æ£€æŸ¥ç›®å½•æƒé™
ls -ld ~/.config/opencode

# 2. æ£€æŸ¥çˆ¶ç›®å½•æƒé™
ls -ld ~/.config

# 3. æ£€æŸ¥å½“å‰ç”¨æˆ·
whoami
```

**è§£å†³æ–¹æ¡ˆ**:

```bash
# æ–¹æ¡ˆ 1: åˆ›å»ºç›®å½•å¹¶è®¾ç½®æƒé™
mkdir -p ~/.config/opencode
chmod 755 ~/.config/opencode

# æ–¹æ¡ˆ 2: ä½¿ç”¨è‡ªå®šä¹‰è¾“å‡ºç›®å½•
compound-plugin install compound-engineering --to opencode --output ~/my-opencode

# æ–¹æ¡ˆ 3: ä¿®å¤çˆ¶ç›®å½•æƒé™
sudo chown -R $(whoami) ~/.config
```

---

### 8.3 è¿è¡Œæ—¶é—®é¢˜

#### é—®é¢˜ 1: ç»„ä»¶æœªåŠ è½½

**ç—‡çŠ¶**: å®‰è£…æˆåŠŸ,ä½† Claude/OpenCode/Codex ä¸­çœ‹ä¸åˆ°ç»„ä»¶

**æ’æŸ¥æ­¥éª¤**:

```bash
# Claude Code
claude /help | grep workflows

# OpenCode
cat ~/.config/opencode/opencode.json | jq '.command | keys'

# Codex
ls ~/.codex/prompts/
ls ~/.codex/skills/
```

**è§£å†³æ–¹æ¡ˆ**:

```bash
# Claude Code: é‡æ–°åŠ è½½æ’ä»¶
claude /plugin reload compound-engineering

# OpenCode: æ£€æŸ¥é…ç½®æ–‡ä»¶
cat ~/.config/opencode/opencode.json | jq .

# Codex: éªŒè¯æ–‡ä»¶å­˜åœ¨
ls -la ~/.codex/prompts/workflows-*.md
```

---

#### é—®é¢˜ 2: Hooks æœªè§¦å‘

**ç—‡çŠ¶**: Hooks è½¬æ¢æˆåŠŸ,ä½†æœªè‡ªåŠ¨æ‰§è¡Œ

**æ’æŸ¥æ­¥éª¤**:

```bash
# OpenCode
cat ~/.config/opencode/plugins/converted-hooks.ts

# æ£€æŸ¥æ’ä»¶åŠ è½½
# (OpenCode æ§åˆ¶å°æŸ¥çœ‹)
```

**è§£å†³æ–¹æ¡ˆ**:

```typescript
// 1. éªŒè¯ Hooks æ’ä»¶æ ¼å¼
// converted-hooks.ts åº”è¯¥å¯¼å‡º Plugin ç±»å‹

// 2. æ£€æŸ¥äº‹ä»¶æ˜ å°„
// ç¡®ä¿ Claude äº‹ä»¶æ­£ç¡®æ˜ å°„åˆ° OpenCode äº‹ä»¶

// 3. æ£€æŸ¥ OpenCode ç‰ˆæœ¬
// æŸäº›äº‹ä»¶å¯èƒ½éœ€è¦ç‰¹å®šç‰ˆæœ¬æ”¯æŒ
```

---

#### é—®é¢˜ 3: æƒé™è¢«æ‹’ç»

**ç—‡çŠ¶**: æ‰§è¡Œå‘½ä»¤æ—¶æç¤ºæƒé™ä¸è¶³

**æ’æŸ¥æ­¥éª¤**:

```bash
# OpenCode
cat ~/.config/opencode/opencode.json | jq '.permission'

# æ£€æŸ¥å·¥å…·å¯ç”¨çŠ¶æ€
cat ~/.config/opencode/opencode.json | jq '.tools'
```

**è§£å†³æ–¹æ¡ˆ**:

```bash
# æ–¹æ¡ˆ 1: ä½¿ç”¨ broad æƒé™æ¨¡å¼
compound-plugin install compound-engineering --to opencode --permissions broad

# æ–¹æ¡ˆ 2: æ‰‹åŠ¨ä¿®æ”¹æƒé™é…ç½®
vim ~/.config/opencode/opencode.json
# ä¿®æ”¹ permission å’Œ tools å­—æ®µ

# æ–¹æ¡ˆ 3: æ·»åŠ ç¼ºå¤±çš„ allowed-tools
# åœ¨å‘½ä»¤çš„ frontmatter ä¸­æ·»åŠ æ‰€éœ€å·¥å…·
```

---

### 8.4 è°ƒè¯•æŠ€å·§

#### æŠ€å·§ 1: å¯ç”¨è¯¦ç»†è¾“å‡º

```bash
# å¯ç”¨è°ƒè¯•æ¨¡å¼
export COMPOUND_PLUGIN_DEBUG=1
compound-plugin install compound-engineering --to opencode

# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
cat ~/.compound-plugin/debug.log
```

#### æŠ€å·§ 2: åˆ†æ­¥éªŒè¯

```bash
# 1. ä»…è½¬æ¢,ä¸å®‰è£…
compound-plugin convert ./plugins/compound-engineering --to opencode --output ./output

# 2. æ£€æŸ¥è¾“å‡º
tree ./output

# 3. éªŒè¯é…ç½®
cat ./output/opencode.json | jq .

# 4. æ‰‹åŠ¨å¤åˆ¶
cp -r ./output/* ~/.config/opencode/
```

#### æŠ€å·§ 3: å¯¹æ¯”å®˜æ–¹æ ¼å¼

```bash
# æŸ¥çœ‹ Claude Code æ ¼å¼
cat plugins/compound-engineering/agents/kieran-rails-reviewer.md

# æŸ¥çœ‹è½¬æ¢åæ ¼å¼
cat ~/.config/opencode/agents/kieran-rails-reviewer.md

# å¯¹æ¯”å·®å¼‚
diff -u plugins/compound-engineering/agents/kieran-rails-reviewer.md \
         ~/.config/opencode/agents/kieran-rails-reviewer.md
```

---

## æ€»ç»“

Compound Engineering Plugin çš„æŠ€æœ¯å®ç°å±•ç¤ºäº†ä¸€ä¸ª **æ¨¡å—åŒ–ã€å¯æ‰©å±•ã€è·¨å¹³å°** çš„ AI é©±åŠ¨å·¥ç¨‹å·¥å…·ç³»ç»Ÿã€‚

**å…³é”®æŠ€æœ¯ç‰¹æ€§**:
- ğŸ”„ **å¤šå¹³å°è½¬æ¢** - Claude Codeã€OpenCodeã€Codex ç»Ÿä¸€æ”¯æŒ
- ğŸ” **æ™ºèƒ½è§£æ** - è‡ªåŠ¨æå–å…ƒæ•°æ®ã€éªŒè¯ç»„ä»¶ç»“æ„
- ğŸ” **ç²¾ç¡®æƒé™** - 3 ç§æƒé™æ¨¡å¼,æ”¯æŒæ¨¡å¼åŒ¹é…
- âš¡ **é«˜æ€§èƒ½** - å¹¶è¡Œå¤„ç†ã€å»¶è¿ŸåŠ è½½ã€ç´¢å¼•ç¼“å­˜
- ğŸ› ï¸ **æ˜“è°ƒè¯•** - è¯¦ç»†æ—¥å¿—ã€é”™è¯¯è¿½è¸ªã€æ€§èƒ½åˆ†æ
- ğŸ“¦ **ç»„ä»¶å¤ç”¨** - ç¬¦å·é“¾æ¥ã€ä¼˜å…ˆçº§é®è”½ã€ä¸ªäººå®šåˆ¶

**æ¶æ„ä¼˜åŠ¿**:
- **è§£è€¦è®¾è®¡** - è§£æå™¨ã€è½¬æ¢å™¨ã€ç›®æ ‡å¤„ç†å™¨ç‹¬ç«‹
- **ç±»å‹å®‰å…¨** - TypeScript å¼ºç±»å‹ç³»ç»Ÿ
- **å¯æ‰©å±•æ€§** - æ˜“äºæ·»åŠ æ–°ç›®æ ‡æ ¼å¼ã€æ–°ç»„ä»¶ç±»å‹
- **å‘åå…¼å®¹** - æ”¯æŒå¤šç‰ˆæœ¬ Claude Code æ’ä»¶æ ¼å¼

**æœ€ä½³å®è·µ**:
- âœ… ä½¿ç”¨ `from-commands` æƒé™æ¨¡å¼ (ç”Ÿäº§ç¯å¢ƒ)
- âœ… å¯ç”¨è°ƒè¯•æ¨¡å¼æ’æŸ¥é—®é¢˜
- âœ… å®šæœŸæ£€æŸ¥æ’ä»¶æ›´æ–°
- âœ… ä¸ªäººå®šåˆ¶ç»„ä»¶æ”¾åœ¨ `~/.claude/` ç­‰ä¸ªäººç›®å½•
- âœ… é¡¹ç›®å®šåˆ¶ç»„ä»¶æ”¾åœ¨ `.claude/` ç­‰é¡¹ç›®ç›®å½•
- âœ… ä½¿ç”¨ç¬¦å·é“¾æ¥å…±äº«æŠ€èƒ½ (èŠ‚çœç©ºé—´)

Compound Engineering Plugin ä¸ä»…å®ç°äº† **è·¨å¹³å°æ’ä»¶è½¬æ¢**,æ›´å±•ç¤ºäº†å¦‚ä½•é€šè¿‡ **ç²¾å¿ƒçš„æŠ€æœ¯è®¾è®¡** å’Œ **å·¥ç¨‹å®è·µ** æ„å»ºä¸€ä¸ª **å¼ºå¤§ã€çµæ´»ã€æ˜“ç”¨** çš„ AI ä»£ç†å·¥å…·ç”Ÿæ€ç³»ç»Ÿã€‚

è¿™ä¸ªå®ç°è¯æ˜äº†: **å¥½çš„å·¥ç¨‹å®è·µ + å·§å¦™çš„æŠ€æœ¯è®¾è®¡ = å¼ºå¤§çš„å¼€å‘è€…å·¥å…·**ã€‚
